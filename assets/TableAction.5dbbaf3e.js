var e=Object.defineProperty,t=Object.defineProperties,n=Object.getOwnPropertyDescriptors,l=Object.getOwnPropertySymbols,o=Object.prototype.hasOwnProperty,i=Object.prototype.propertyIsEnumerable,a=(t,n,l)=>n in t?e(t,n,{enumerable:!0,configurable:!0,writable:!0,value:l}):t[n]=l,s=(e,t)=>{for(var n in t||(t={}))o.call(t,n)&&a(e,n,t[n]);if(l)for(var n of l(t))i.call(t,n)&&a(e,n,t[n]);return e},r=(e,l)=>t(e,n(l)),u=(e,t,n)=>new Promise(((l,o)=>{var i=e=>{try{s(n.next(e))}catch(t){o(t)}},a=e=>{try{s(n.throw(e))}catch(t){o(t)}},s=e=>e.done?l(e.value):Promise.resolve(e.value).then(i,a);s((n=n.apply(e,t)).next())}));import{bi as c,bj as d,d as f,S as p,bk as g,bl as m,bm as v,f as h,j as b,k as y,bn as C,i as k,B as S,x as w,q as x,X as O,o as P,c as z,a4 as R,b as E,bh as N,bo as _,af as L,b1 as D,aT as j,aF as V,ak as A,aK as T,b6 as I,s as F,aR as B,bp as $,bq as M,br as U,bs as q,bt as H,bu as K,bv as W,w as Q,v as X,t as Y,Y as J,bw as G,N as Z,av as ee,bx as te,g as ne,aQ as le,by as oe,bz as ie,bA as ae,p as se,a as re,a5 as ue,bB as ce,r as de,F as fe,e as pe,bC as ge}from"./vendor.753c6347.js";import{d as me,u as ve}from"./useDesignSetting.54915fd4.js";import{i as he,a as be,b as ye,c as Ce,d as ke,e as Se,f as we}from"./index.c7a2ed8c.js";import{p as xe}from"./propTypes.34968b9b.js";import{c as Oe}from"./componentSetting.df76d574.js";import{t as Pe,a as ze,u as Re}from"./index.esm.0d4307b1.js";const Ee=Symbol("s-table");function Ne(){return c(Ee)}var _e=f({name:"ColumnSetting",components:{SettingOutlined:p,DragOutlined:g,Draggable:me,VerticalRightOutlined:m,VerticalLeftOutlined:v},setup(){const{getDarkTheme:e}=ve(),t=Ne(),n=h([]),l=h([]),o=b({selection:!1,checkAll:!0,checkList:[],defaultCheckList:[]}),i=y((()=>o.selection));function a(e){t.setColumns(e)}function u(){let e=[];return t.getColumns().forEach((t=>{e.push(s({},t))})),e}return C((()=>{t.getColumns().length&&function(){const e=u(),t=e.map((e=>e.key));o.checkList=t,o.defaultCheckList=t;const i=e.filter((e=>"action"!=e.key&&"操作"!=e.title));n.value.length||(n.value=x(i),l.value=x(i))}()})),r(s({},k(o)),{columnsList:n,getDarkTheme:e,onChange:function(e){o.selection&&e.unshift("selection"),a(e)},onCheckAll:function(e){let n=t.getCacheColumns(!0);e?(a(n),o.checkList=n):(a([]),o.checkList=[])},onSelection:function(e){let n=t.getCacheColumns();e?(n.unshift({type:"selection",key:"selection"}),a(n)):(n.splice(0,1),a(n))},resetColumns:function(){o.checkList=[...o.defaultCheckList],o.checkAll=!0;let e=t.getCacheColumns().map((e=>r(s({},e),{fixed:void 0})));a(e),n.value=e},fixedColumn:function(e,l){if(!o.checkList.includes(e.key))return;let i=u();const s=e.fixed===l?void 0:l;let r=i.findIndex((t=>t.key===e.key));-1!==r&&(i[r].fixed=s),t.setCacheColumnsField(e.key,{fixed:s}),n.value[r].fixed=s,a(i)},draggableEnd:function(){const e=S(w(n));n.value=e,a(e)},getSelection:i})}});const Le={class:"cursor-pointer table-toolbar-right-icon"},De={class:"table-toolbar-inner-popover-title"},je=N("列展示"),Ve=N("勾选列"),Ae=N("重置"),Te={class:"table-toolbar-inner"},Ie={class:"drag-icon"},Fe={class:"fixed-item"},Be=E("span",null,"固定到左侧",-1),$e=E("span",null,"固定到右侧",-1),Me=E("span",null,"列设置",-1);var Ue,qe;_e.render=function(e,t,n,l,o,i){const a=O("SettingOutlined"),s=O("n-icon"),r=O("n-checkbox"),u=O("n-button"),c=O("n-space"),d=O("DragOutlined"),f=O("VerticalRightOutlined"),p=O("n-tooltip"),g=O("n-divider"),m=O("VerticalLeftOutlined"),v=O("Draggable"),h=O("n-checkbox-group"),b=O("n-popover");return P(),z(p,{trigger:"hover"},{trigger:R((()=>[E("div",Le,[E(b,{trigger:"click",width:230,class:"toolbar-popover",placement:"bottom-end"},{trigger:R((()=>[E(s,{size:"18"},{default:R((()=>[E(a)])),_:1})])),header:R((()=>[E("div",De,[E(c,null,{default:R((()=>[E(r,{checked:e.checkAll,"onUpdate:checked":[t[1]||(t[1]=t=>e.checkAll=t),e.onCheckAll]},{default:R((()=>[je])),_:1},8,["checked","onUpdate:checked"]),E(r,{checked:e.selection,"onUpdate:checked":[t[2]||(t[2]=t=>e.selection=t),e.onSelection]},{default:R((()=>[Ve])),_:1},8,["checked","onUpdate:checked"]),E(u,{text:"",type:"info",size:"small",class:"mt-1",onClick:e.resetColumns},{default:R((()=>[Ae])),_:1},8,["onClick"])])),_:1})])])),default:R((()=>[E("div",Te,[E(h,{value:e.checkList,"onUpdate:value":[t[4]||(t[4]=t=>e.checkList=t),e.onChange]},{default:R((()=>[E(v,{modelValue:e.columnsList,"onUpdate:modelValue":t[3]||(t[3]=t=>e.columnsList=t),animation:"300","item-key":"key",onEnd:e.draggableEnd},{item:R((({element:t})=>[E("div",{class:["table-toolbar-inner-checkbox",{"table-toolbar-inner-checkbox-dark":!0===e.getDarkTheme}]},[E("span",Ie,[E(s,{size:"18"},{default:R((()=>[E(d)])),_:1})]),E(r,{value:t.key,label:t.title},null,8,["value","label"]),E("div",Fe,[E(p,{trigger:"hover",placement:"bottom"},{trigger:R((()=>[E(s,{size:"18",color:"left"===t.fixed?"#2080f0":void 0,class:"cursor-pointer",onClick:n=>e.fixedColumn(t,"left")},{default:R((()=>[E(f)])),_:2},1032,["color","onClick"])])),default:R((()=>[Be])),_:2},1024),E(g,{vertical:""}),E(p,{trigger:"hover",placement:"bottom"},{trigger:R((()=>[E(s,{size:"18",color:"right"===t.fixed?"#2080f0":void 0,class:"cursor-pointer",onClick:n=>e.fixedColumn(t,"right")},{default:R((()=>[E(m)])),_:2},1032,["color","onClick"])])),default:R((()=>[$e])),_:2},1024)])],2)])),_:1},8,["modelValue","onEnd"])])),_:1},8,["value","onUpdate:value"])])])),_:1})])])),default:R((()=>[Me])),_:1})},(qe=Ue||(Ue={})).NInput="on-input",qe.NInputNumber="on-input",qe.NSelect="on-update:value",qe.NSwitch="on-update:value",qe.NCheckbox="on-update:value",qe.NDatePicker="on-update:value",qe.NTimePicker="on-update:value";const He=new Map;He.set("NInput",L),He.set("NInputNumber",D),He.set("NSelect",j),He.set("NSwitch",V),He.set("NCheckbox",A),He.set("NDatePicker",T),He.set("NTimePicker",I);function Ke(e,t,n){e&&t&&n&&e.addEventListener(t,n,!1)}const We=new Map;let Qe;function Xe(e,t){let n=[];return Array.isArray(t.arg)?n=t.arg:n.push(t.arg),function(l,o){const i=t.instance.popperRef,a=l.target,s=o.target,r=!t||!t.instance,u=!a||!s,c=e.contains(a)||e.contains(s),d=e===a,f=n.length&&n.some((e=>null==e?void 0:e.contains(a)))||n.length&&n.includes(s),p=i&&(i.contains(a)||i.contains(s));r||u||c||d||f||p||t.value()}}he||(Ke(document,"mousedown",(e=>Qe=e)),Ke(document,"mouseup",(e=>{for(const{documentHandler:t}of We.values())t(e,Qe)})));function Ye(e){return"NInput"===e?"请输入":["NPicker","NSelect","NCheckbox","NRadio","NSwitch","NDatePicker","NTimePicker"].includes(e)?"请选择":""}function Je(e,t){if(t.length<e)throw new TypeError(e+" argument"+(e>1?"s":"")+" required, but only "+t.length+" present")}function Ge(e){var t=e.years,n=e.months,l=e.weeks,o=e.days,i=e.hours,a=e.minutes,s=e.seconds;Je(1,arguments);var r=0;t&&(r+=365.2425*t),n&&(r+=30.436875*n),l&&(r+=7*l),o&&(r+=o);var u=24*r*60*60;return i&&(u+=60*i*60),a&&(u+=60*a),s&&(u+=s),Math.round(1e3*u)}var Ze=f({name:"EditableCell",components:{FormOutlined:$,CloseOutlined:M,CheckOutlined:U,CellComponent:({component:e="NInput",rule:t=!0,ruleMessage:n,popoverVisible:l},{attrs:o})=>{const i=He.get(e),a=F(i,o);return t?F(B,{"display-directive":"show",show:!!l,manual:"manual"},{trigger:()=>a,default:()=>F("span",{style:{color:"red",width:"90px",display:"inline-block"}},{default:()=>n})}):a}},directives:{clickOutside:{beforeMount(e,t){We.set(e,{documentHandler:Xe(e,t),bindingFn:t.value})},updated(e,t){We.set(e,{documentHandler:Xe(e,t),bindingFn:t.value})},unmounted(e){We.delete(e)}}},props:{value:{type:[String,Number,Boolean,Object],default:""},record:{type:Object},column:{type:Object,default:()=>({})},index:xe.number},setup(e){const t=Ne(),n=h(!1),l=h(),o=h(!1),i=h(""),a=h([]),c=h(e.value),d=h(e.value),f=y((()=>{var t;return(null==(t=e.column)?void 0:t.editComponent)||"NInput"})),p=y((()=>{var t;return null==(t=e.column)?void 0:t.editRule})),g=y((()=>w(i)&&w(o))),m=y((()=>{const e=w(f);return["NCheckbox","NSwitch"].includes(e)})),v=y((()=>{var t,n,l,o;const i=null!=(n=null==(t=e.column)?void 0:t.editComponentProps)?n:{},a=null!=(o=null==(l=e.column)?void 0:l.editComponent)?o:null,u=w(f),d=w(m),p=d?"checked":"value",g=w(c);let v=d?be(g)&&ye(g)?g:!!g:g;Ce(v)&&"NDatePicker"===u?v=Ge(v):ke(v)&&"NDatePicker"===u&&(v=v.map((e=>Ge(e))));const h=a?Ue[a]:void 0;return r(s(s({placeholder:Ye(w(f))},{}),q(i,"onChange")),{[h]:P,[p]:v})})),b=y((()=>{var t,n;const{editComponentProps:l,editValueMap:o}=e.column,i=w(c);if(o&&Se(o))return o(i);if(!w(f).includes("NSelect"))return i;const s=(null!=(t=null==l?void 0:l.options)?t:w(a)||[]).find((e=>`${e.value}`==`${i}`));return null!=(n=null==s?void 0:s.label)?n:i})),k=y((()=>({width:"calc(100% - 48px)"}))),x=y((()=>{const{align:t="center"}=e.column;return`edit-cell-align-${t}`})),O=y((()=>{const{editable:t}=e.record||{};return!!t}));function P(n){return u(this,arguments,(function*(n){var l,o,i;const a=w(f);n?(null==n?void 0:n.target)&&Reflect.has(n.target,"value")?c.value=n.target.value:"NCheckbox"===a?c.value=n.target.checked:(Ce(n)||ye(n)||be(n))&&(c.value=n):c.value=n;const s=null==(o=null==(l=e.column)?void 0:l.editComponentProps)?void 0:o.onChange;s&&Se(s)&&s(...arguments),null==(i=t.emit)||i.call(t,"edit-change",{column:e.column,value:w(c),record:S(e.record)}),yield z()}))}function z(){return u(this,null,(function*(){const{column:t,record:n}=e,{editRule:l}=t,a=w(c);if(l){if(ye(l)&&!a&&!be(a)){o.value=!0;const e=w(f);return i.value=Ye(e),!1}if(Se(l)){const e=yield l(a,n);return e?(i.value=e,o.value=!0,!1):(i.value="",!0)}}return i.value="",!0}))}function R(l=!0,o=!0){return u(this,null,(function*(){var i;if(o){if(!(yield z()))return!1}const{column:a,index:s,record:r}=e;if(!r)return!1;const{key:u}=a,d=w(c);if(!u)return;K(r,u,d),l&&(null==(i=t.emit)||i.call(t,"edit-end",{record:r,index:s,key:u,value:d})),n.value=!1}))}function E(){var l;n.value=!1,c.value=d.value;const{column:a,index:s,record:r}=e,{key:u}=a;o.value=!0,i.value="",null==(l=t.emit)||l.call(t,"edit-cancel",{record:r,index:s,key:u,value:w(c)})}function N(t,n){var l;e.record&&(ke(e.record[t])?null==(l=e.record[t])||l.push(n):e.record[t]=[n])}return C((()=>{d.value=e.value})),C((()=>{const{editable:t}=e.column;(ye(t)||ye(w(O)))&&(n.value=!!t||w(O))})),e.record&&(N("submitCbs",R),N("validCbs",z),N("cancelCbs",E),e.column.key&&(e.record.editValueRefs||(e.record.editValueRefs={}),e.record.editValueRefs[e.column.key]=c),e.record.onCancelEdit=()=>{var t,n;ke(null==(t=e.record)?void 0:t.cancelCbs)&&(null==(n=e.record)||n.cancelCbs.forEach((e=>e())))},e.record.onSubmitEdit=()=>u(this,null,(function*(){var n,l,o,i;if(ke(null==(n=e.record)?void 0:n.submitCbs)){const n=((null==(l=e.record)?void 0:l.validCbs)||[]).map((e=>e()));if(!(yield Promise.all(n)).every((e=>!!e)))return;return((null==(o=e.record)?void 0:o.submitCbs)||[]).forEach((e=>e(!1,!1))),null==(i=t.emit)||i.call(t,"edit-row-end"),!0}}))),{isEdit:n,handleEdit:function(){var t;w(O)||w(null==(t=e.column)?void 0:t.editRow)||(i.value="",n.value=!0,H((()=>{var e;const t=w(l);null==(e=null==t?void 0:t.focus)||e.call(t)})))},currentValueRef:c,handleSubmit:R,handleChange:P,handleCancel:E,elRef:l,getComponent:f,getRule:p,onClickOutside:function(){var t;if((null==(t=e.column)?void 0:t.editable)||w(O))return;w(f).includes("NInput")&&E()},ruleMessage:i,getRuleVisible:g,getComponentProps:v,handleOptionsChange:function(e){a.value=e},getWrapperStyle:k,getWrapperClass:x,getRowEditable:O,getValues:b,handleEnter:function(){return u(this,null,(function*(){var t;(null==(t=e.column)?void 0:t.editRow)||(yield R())}))}}}});const et={class:"editable-cell"},tt={class:"flex editable-cell-content"},nt={key:0,class:"editable-cell-action"};function lt(e){const t=h(w(e).columns);let n=w(e).columns;const l=y((()=>{const n=x(w(t));return function(e,t){const{actionColumn:n}=w(e);if(!n)return;t.push(s({},n))}(e,n),n||[]})),{hasPermission:o}=we();const i=y((()=>{const e=w(l);return x(e).filter((e=>o(e.auth)&&function(e){const t=e.ifShow;let n=!0;return ye(t)&&(n=t),Se(t)&&(n=t(e)),n}(e))).map((e=>{const{edit:t}=e;if(t&&(e.render=function(e){return(t,n)=>{const l=e.key,o=t[l];return t.onEdit=(e,n=!1)=>u(this,null,(function*(){var l,o;return n||(t.editable=e),!e&&n?!!(yield null==(l=t.onSubmitEdit)?void 0:l.call(t))&&(t.editable=!1,!0):(e||n||null==(o=t.onCancelEdit)||o.call(t),!0)})),F(Ze,{value:o,record:t,column:e,index:n})}}(e),t)){const t=e.title;e.title=()=>{return e=F("span",{},[F("span",{style:{"margin-right":"5px"}},t),F(Z,{size:14},{default:()=>F($)})]),n="该列可编辑",F(ee,null,{trigger:()=>e,default:()=>n});var e,n}}return e}))}));return _((()=>w(e).columns),(e=>{t.value=e,n=e})),{getColumnsRef:l,getCacheColumns:function(e){return e?n.map((e=>e.key)):n},setCacheColumnsField:function(e,t){e&&t&&n.forEach((n=>{n.key!==e||Object.assign(n,t)}))},setColumns:function(e){const l=x(e);if(!ke(l))return;if(!l.length)return void(t.value=[]);const o=n.map((e=>e.key));if(Ce(l[0])){const i=[];n.forEach((t=>{e.includes(t.key)&&i.push(s({},t))})),te(o,l)||i.sort(((e,t)=>o.indexOf(e.key)-o.indexOf(t.key))),t.value=i}else t.value=l},getColumns:function(){return S(w(l)).map((e=>r(s({},e),{title:e.title,key:e.key,fixed:e.fixed||void 0})))},getPageColumns:i}}Ze.render=function(e,t,n,l,o,i){const a=O("FormOutlined"),s=O("n-icon"),r=O("CellComponent"),u=O("CheckOutlined"),c=O("CloseOutlined"),d=W("click-outside");return P(),z("div",et,[Q(E("div",{class:"editable-cell-content",onClick:t[1]||(t[1]=(...t)=>e.handleEdit&&e.handleEdit(...t))},[N(Y(e.getValues)+" ",1),e.column.editRow?J("",!0):(P(),z(s,{key:0,class:"edit-icon"},{default:R((()=>[E(a)])),_:1}))],512),[[X,!e.isEdit]]),Q(E("div",tt,[E(r,G(e.getComponentProps,{component:e.getComponent,style:e.getWrapperStyle,popoverVisible:e.getRuleVisible,ruleMessage:e.ruleMessage,rule:e.getRule,class:e.getWrapperClass,ref:"elRef",onOptionsChange:e.handleOptionsChange,onPressEnter:e.handleEnter}),null,16,["component","style","popoverVisible","ruleMessage","rule","class","onOptionsChange","onPressEnter"]),e.getRowEditable?J("",!0):(P(),z("div",nt,[E(s,{class:"cursor-pointer mx-2"},{default:R((()=>[E(u,{onClick:e.handleSubmit},null,8,["onClick"])])),_:1}),E(s,{class:"cursor-pointer mx-2"},{default:R((()=>[E(c,{onClick:e.handleCancel},null,8,["onClick"])])),_:1})]))],512),[[X,e.isEdit],[d,e.onClickOutside]])])};const{table:ot}=Oe,{apiSetting:it,defaultPageSize:at,pageSizes:st}=ot,rt=at,ut=it,ct=st;const dt=r(s({},le.props),{title:{type:String,default:null},titleTooltip:{type:String,default:null},size:{type:String,default:"medium"},tableData:{type:[Object],default:()=>[]},columns:{type:[Array],default:()=>[],required:!0},request:{type:Function,default:null,required:!0},rowKey:{type:[String,Function],default:void 0},pagination:{type:[Object,Boolean],default:()=>{}},showPagination:{type:[String,Boolean],default:"auto"},actionColumn:{type:Object,default:null},canResize:xe.bool.def(!0),resizeHeightOffset:xe.number.def(0)});const ft=[{type:"menu",label:"紧凑",key:"small"},{type:"menu",label:"默认",key:"medium"},{type:"menu",label:"宽松",key:"large"}];var pt=f({components:{ReloadOutlined:oe,ColumnHeightOutlined:ie,ColumnSetting:_e,QuestionCircleOutlined:ae},props:s({},dt),emits:["fetch-success","fetch-error","update:checked-row-keys","edit-end","edit-cancel","edit-row-end","edit-change"],setup(e,{emit:t}){const n=h(150),l=h(null),o=h(null);let i;const a=h([]),c=h(),f=y((()=>s(s({},e),w(c)))),{getLoading:p,setLoading:g}=function(e){const t=h(w(e).loading);return _((()=>w(e).loading),(e=>{t.value=e})),{getLoading:y((()=>w(t))),setLoading:function(e){t.value=e}}}(f),{getPaginationInfo:m,setPagination:v}=function(e){const t=h({}),n=h(!0),l=y((()=>{const{pagination:l}=w(e);return!(!w(n)||ye(l)&&!l)&&s(s({pageSize:rt,pageSizes:ct,showSizePicker:!0,showQuickJumper:!0},ye(l)?{}:l),w(t))}));return{getPagination:function(){return w(l)},getPaginationInfo:l,setShowPagination:function(e){return u(this,null,(function*(){n.value=e}))},getShowPagination:function(){return w(n)},setPagination:function(e){const n=w(l);t.value=s(s({},ye(n)?{}:n),e)}}}(f),{getDataSourceRef:x,getRowKey:O,reload:P}=function(e,{getPaginationInfo:t,setPagination:n,setLoading:l,tableData:o},i){const a=h([]);C((()=>{o.value=w(a)})),_((()=>w(e).dataSource),(()=>{const{dataSource:t}=w(e);t&&(a.value=t)}),{immediate:!0});const r=y((()=>{const{rowKey:t}=w(e);return t||(()=>"key")})),c=y((()=>{const e=w(a);return e&&e.length,w(a)}));function d(o){return u(this,null,(function*(){try{l(!0);const{request:r,pagination:u}=w(e),c=ut.pageField,f=ut.sizeField,p=ut.totalField,g=ut.listField;let m={};const{page:v=1,pageSize:h=10}=w(t);ye(u)&&!u||ye(t)?m={}:(m[c]=o&&o[c]||v,m[f]=h);const b=s({},m),y=yield r(b),C=y[p]||0,k=y[c];C&&v>C&&(n({[c]:C}),d(o));const S=y[g]?y[g]:[];a.value=S,n({[c]:k,[p]:C}),o&&o[c]&&n({[c]:o[c]||1}),i("fetch-success",{items:w(S),resultTotal:C})}catch(r){i("fetch-error",r),a.value=[]}finally{l(!1)}}))}return ne((()=>{setTimeout((()=>{d()}),16)})),{fetch:d,getRowKey:r,getDataSourceRef:c,getDataSource:function(){return c.value},setTableData:function(e){a.value=e},reload:function(e){return u(this,null,(function*(){yield d(e)}))}}}(f,{getPaginationInfo:m,setPagination:v,tableData:a,setLoading:g},t),{getPageColumns:z,setColumns:R,getColumns:E,getCacheColumns:N,setCacheColumnsField:L}=lt(f),D=b({tableSize:"medium",isColumnSetting:!1});const j=y((()=>D.tableSize)),V=y((()=>{const e=w(x),t=e.length?`${w(n)}px`:"auto";return r(s({},w(f)),{loading:w(p),columns:S(w(z)),rowKey:w(O),data:e,size:w(j),remote:!0,"max-height":t})})),A=y((()=>S(w(m))));const T={reload:P,setColumns:R,setLoading:g,setProps:function(e){c.value=s(s({},w(c)),e)},getColumns:E,getPageColumns:z,getCacheColumns:N,setCacheColumnsField:L,emit:t,getSize:()=>w(V).size},I=y((()=>{const{canResize:e}=w(f);return e}));function F(){return u(this,null,(function*(){const t=w(l);if(!t)return;if(!w(I))return;const o=null==t?void 0:t.$el,a=o.querySelector(".n-data-table-thead "),{bottomIncludeBody:s}=function(e){const t=document.documentElement,n=t.scrollLeft,l=t.scrollTop,o=t.clientLeft,i=t.clientTop,a=window.pageXOffset,s=window.pageYOffset,r=function(e){return e&&e.getBoundingClientRect?e.getBoundingClientRect():0}(e),{left:u,top:c,width:d,height:f}=r,p=u+a-((a||n)-(o||0)),g=c+s-((s||l)-(i||0)),m=window.document.documentElement.clientWidth,v=window.document.documentElement.clientHeight;return{left:p,top:g,right:m-d-p,bottom:v-f-g,rightIncludeBody:m-p,bottomIncludeBody:v-g}}(a);let r=2;if(!ye(A))if(i=o.querySelector(".n-data-table__pagination"),i){r+=i.offsetHeight||0}else r+=28;let u=s-(64+r+24+(e.resizeHeightOffset||0));const c=e.maxHeight;u=c&&c<u?c:u,n.value=u}))}var B;return function(e,t=150,n){let l=()=>{e()};const o=Re(l,t);l=o;const i=()=>{n&&n.immediate&&l(),window.addEventListener("resize",l)},a=()=>{window.removeEventListener("resize",l)};Pe((()=>{i()})),ze((()=>{a()}))}(F,280),ne((()=>{H((()=>{F()}))})),B=r(s({},T),{wrapRef:o,getBindValues:V}),d(Ee,B),r(s({},k(D)),{tableElRef:l,getBindValues:V,densityOptions:ft,reload:P,densitySelect:function(e){D.tableSize=e},updatePage:function(e){v({page:e}),P()},updatePageSize:function(e){v({page:1,pageSize:e}),P()},updateCheckedRowKeys:function(e){t("update:checked-row-keys",e)},pagination:A,tableAction:T})}});const gt=pe();se("data-v-017e3152");const mt={class:"table-toolbar"},vt={class:"flex items-center table-toolbar-left"},ht={key:0,class:"table-toolbar-left-title"},bt={class:"flex items-center table-toolbar-right"},yt=E("span",null,"刷新",-1),Ct={class:"table-toolbar-right-icon"},kt=E("span",null,"密度",-1),St={class:"s-table"};re();const wt=gt(((e,t,n,l,o,i)=>{const a=O("QuestionCircleOutlined"),s=O("n-icon"),r=O("n-tooltip"),u=O("ReloadOutlined"),c=O("ColumnHeightOutlined"),d=O("n-dropdown"),f=O("ColumnSetting"),p=O("n-data-table");return P(),z(fe,null,[E("div",mt,[E("div",vt,[e.title?(P(),z("div",ht,[N(Y(e.title)+" ",1),e.titleTooltip?(P(),z(r,{key:0,trigger:"hover"},{trigger:gt((()=>[E(s,{size:"18",class:"ml-1 cursor-pointer text-gray-400"},{default:gt((()=>[E(a)])),_:1})])),default:gt((()=>[N(" "+Y(e.titleTooltip),1)])),_:1})):J("",!0)])):J("",!0),ue(e.$slots,"tableTitle",{},void 0,!0)]),E("div",bt,[ue(e.$slots,"toolbar",{},void 0,!0),E(r,{trigger:"hover"},{trigger:gt((()=>[E("div",{class:"table-toolbar-right-icon",onClick:t[1]||(t[1]=(...t)=>e.reload&&e.reload(...t))},[E(s,{size:"18"},{default:gt((()=>[E(u)])),_:1})])])),default:gt((()=>[yt])),_:1}),E(r,{trigger:"hover"},{trigger:gt((()=>[E("div",Ct,[E(d,{onSelect:e.densitySelect,trigger:"click",options:e.densityOptions,value:e.tableSize,"onUpdate:value":t[2]||(t[2]=t=>e.tableSize=t)},{default:gt((()=>[E(s,{size:"18"},{default:gt((()=>[E(c)])),_:1})])),_:1},8,["onSelect","options","value"])])])),default:gt((()=>[kt])),_:1}),E(f)])]),E("div",St,[E(p,G({ref:"tableElRef"},e.getBindValues,{pagination:e.pagination,"onUpdate:page":e.updatePage,"onUpdate:pageSize":e.updatePageSize}),ce({_:2},[de(Object.keys(e.$slots),(t=>({name:t,fn:gt((n=>[ue(e.$slots,t,n,void 0,!0)]))})))]),1040,["pagination","onUpdate:page","onUpdate:pageSize"])])],64)}));pt.render=wt,pt.__scopeId="data-v-017e3152";var xt=f({name:"TableAction",components:{DownOutlined:ge},props:{actions:{type:Array,default:null,required:!0},dropDownActions:{type:Array,default:null},style:{type:String,default:"button"},select:{type:Function,default:()=>{}}},setup(e){const{hasPermission:t}=we(),n="button"===e.style?"default":"text"===e.style?"primary":"default",l="button"===e.style?void 0:"text"===e.style||void 0,o=y((()=>({text:l,type:n,size:"small"}))),i=y((()=>(S(e.dropDownActions)||[]).filter((e=>t(e.auth)&&a(e))).map((e=>{const{popConfirm:t}=e;return r(s(s({size:"small",text:l,type:n},e),t),{onConfirm:null==t?void 0:t.confirm,onCancel:null==t?void 0:t.cancel})}))));function a(e){const t=e.ifShow;let n=!0;return ye(t)&&(n=t),Se(t)&&(n=t(e)),n}return{getActions:y((()=>(S(e.actions)||[]).filter((e=>t(e.auth)&&a(e))).map((e=>{const{popConfirm:t}=e;return r(s(s({size:"small",text:l,type:n},e),t||{}),{onConfirm:null==t?void 0:t.confirm,onCancel:null==t?void 0:t.cancel,enable:!!t})})))),getDropdownList:i,getMoreProps:o}}});const Ot={class:"tableAction"},Pt={class:"flex items-center justify-center"},zt={class:"flex items-center"},Rt=E("span",null,"更多",-1);xt.render=function(e,t,n,l,o,i){const a=O("n-button"),s=O("DownOutlined"),r=O("n-icon"),u=O("n-dropdown");return P(),z("div",Ot,[E("div",Pt,[(P(!0),z(fe,null,de(e.getActions,((e,t)=>(P(),z(a,G({key:`${t}-${e.label}`},e,{class:"mx-2"}),{default:R((()=>[N(Y(e.label),1)])),_:2},1040)))),128)),e.dropDownActions&&e.getDropdownList.length?(P(),z(u,{key:0,trigger:"hover",options:e.getDropdownList,onSelect:e.select},{default:R((()=>[ue(e.$slots,"more"),e.$slots.more?J("",!0):(P(),z(a,G({key:0},e.getMoreProps,{class:"mx-2","icon-placement":"right"}),{default:R((()=>[E("div",zt,[Rt,E(r,{size:"14",class:"ml-1"},{default:R((()=>[E(s)])),_:1})])])),_:1},16))])),_:3},8,["options","onSelect"])):J("",!0)])])};export{pt as _,xt as a};
