var e=Object.defineProperty,t=Object.defineProperties,n=Object.getOwnPropertyDescriptors,a=Object.getOwnPropertySymbols,o=Object.prototype.hasOwnProperty,l=Object.prototype.propertyIsEnumerable,i=(t,n,a)=>n in t?e(t,n,{enumerable:!0,configurable:!0,writable:!0,value:a}):t[n]=a,s=(e,t)=>{for(var n in t||(t={}))o.call(t,n)&&i(e,n,t[n]);if(a)for(var n of a(t))l.call(t,n)&&i(e,n,t[n]);return e},c=(e,a)=>t(e,n(a)),r=(e,t,n)=>new Promise(((a,o)=>{var l=e=>{try{s(n.next(e))}catch(t){o(t)}},i=e=>{try{s(n.throw(e))}catch(t){o(t)}},s=e=>e.done?a(e.value):Promise.resolve(e.value).then(l,i);s((n=n.apply(e,t)).next())}));import{aS as u,aT as d,d as g,aU as p,aV as f,aW as m,aX as h,aY as b,f as k,j as v,k as y,aZ as C,i as S,u as z,x as P,O,o as w,c as _,V as x,b as L,aR as T,a_ as R,q as D,a$ as F,g as U,b0 as j,aK as A,p as V,a as K,t as q,Q as E,X as I,b1 as B,b2 as $,r as Q,F as H,e as M,s as X,ao as J,a8 as W,S as Y}from"./vendor.d43c22c4.js";import{d as Z}from"./vuedraggable.76173ee5.js";import{i as G,a as N,b as ee,A as te}from"./index.a09c13a4.js";const ne=Symbol("s-table");var ae=g({name:"ColumnSetting",components:{ReloadOutlined:p,ColumnHeightOutlined:f,SettingOutlined:m,DragOutlined:h,Draggable:Z,VerticalAlignTopOutlined:b},setup(e,{emit:t}){const n=u(ne),a=k([]),o=v({selection:!1,checkAll:!0,checkList:[],defaultCheckList:[]}),l=y((()=>o.selection));function i(e){n.setColumns(e)}function r(){const e=[];return n.getColumns().forEach((t=>{e.push(s({},t))})),e}return C((()=>{n.getColumns().length&&function(){const e=r(),t=e.map((e=>e.key));o.checkList=t,o.defaultCheckList=t,a.value=e}()})),c(s({},S(o)),{columnsList:a,onChange:function(e){o.selection&&e.unshift("selection"),i(e)},onCheckAll:function(e){let t=n.getCacheColumns(!0);e?(i(t),o.checkList=t):(i([]),o.checkList=[])},onSelection:function(e){let t=n.getCacheColumns();e?(t.unshift({type:"selection",key:"selection"}),i(t)):(t.splice(0,1),i(t))},resetColumns:function(){o.checkList=[...o.defaultCheckList],o.checkAll=!0,i(n.getCacheColumns(!0))},fixedColumn:function(e,t){let o=r(),l=o[e];const s=l.fixed===t?void 0:t;l.fixed=s,a.value=o,n.setCacheColumnsField(l.key,{fixed:s}),i(o)},draggableEnd:function(e){i(z(P(a)))},getSelection:l})}});const oe={class:"cursor-pointer table-toolbar-right-icon"},le={class:"table-toolbar-inner-popover-title"},ie=T("列展示"),se=T("勾选列"),ce=T("重置"),re={class:"table-toolbar-inner"},ue={class:"table-toolbar-inner-checkbox"},de={class:"drag-icon"},ge={class:"fixed-item"},pe=L("span",null,"固定到左侧",-1),fe=L("span",null,"固定到右侧",-1),me=L("span",null,"列设置",-1);ae.render=function(e,t,n,a,o,l){const i=O("SettingOutlined"),s=O("n-icon"),c=O("n-checkbox"),r=O("n-button"),u=O("n-space"),d=O("DragOutlined"),g=O("n-checkbox-group"),p=O("VerticalAlignTopOutlined"),f=O("n-tooltip"),m=O("n-divider"),h=O("Draggable"),b=O("n-popover");return w(),_(f,{trigger:"hover"},{trigger:x((()=>[L("div",oe,[L(b,{trigger:"click",width:230,class:"toolbar-popover",placement:"bottom-end"},{trigger:x((()=>[L(s,{size:"18"},{default:x((()=>[L(i)])),_:1})])),header:x((()=>[L("div",le,[L(u,null,{default:x((()=>[L(c,{checked:e.checkAll,"onUpdate:checked":[t[1]||(t[1]=t=>e.checkAll=t),e.onCheckAll]},{default:x((()=>[ie])),_:1},8,["checked","onUpdate:checked"]),L(c,{checked:e.selection,"onUpdate:checked":[t[2]||(t[2]=t=>e.selection=t),e.onSelection]},{default:x((()=>[se])),_:1},8,["checked","onUpdate:checked"]),L(r,{text:"",type:"info",size:"small",class:"mt-1",onClick:e.resetColumns},{default:x((()=>[ce])),_:1},8,["onClick"])])),_:1})])])),default:x((()=>[L("div",re,[L(h,{modelValue:e.columnsList,"onUpdate:modelValue":t[4]||(t[4]=t=>e.columnsList=t),animation:"300","item-key":"key",onEnd:e.draggableEnd},{item:x((({element:n,index:a})=>[L("div",ue,[L("span",de,[L(s,{size:"18"},{default:x((()=>[L(d)])),_:1})]),L(g,{value:e.checkList,"onUpdate:value":[t[3]||(t[3]=t=>e.checkList=t),e.onChange]},{default:x((()=>[L(c,{value:n.key,label:n.title},null,8,["value","label"])])),_:2},1032,["value","onUpdate:value"]),L("div",ge,[L(f,{trigger:"hover",placement:"bottom"},{trigger:x((()=>[L(s,{size:"18",color:"left"===n.fixed?"#2080f0":void 0,class:"transform -rotate-90 cursor-pointer",onClick:t=>e.fixedColumn(a,"left")},{default:x((()=>[L(p)])),_:2},1032,["color","onClick"])])),default:x((()=>[pe])),_:2},1024),L(m,{vertical:""}),L(f,{trigger:"hover",placement:"bottom"},{trigger:x((()=>[L(s,{size:"18",color:"right"===n.fixed?"#2080f0":void 0,class:"transform rotate-90 cursor-pointer",onClick:t=>e.fixedColumn(a,"right")},{default:x((()=>[L(p)])),_:2},1032,["color","onClick"])])),default:x((()=>[fe])),_:2},1024)])])])),_:1},8,["modelValue","onEnd"])])])),_:1})])])),default:x((()=>[me])),_:1})};const{table:he}={table:{apiSetting:{pageField:"page",sizeField:"pageSize",listField:"list",totalField:"pageCount"},defaultPageSize:10,pageSizes:[10,20,30,40,50]}},{apiSetting:be,defaultPageSize:ke,pageSizes:ve}=he,ye=ke,Ce=be,Se=ve;const ze={title:{type:String,default:null},titleTooltip:{type:String,default:null},size:{type:String,default:"medium"},tableData:{type:[Object],default:()=>{}},columns:{type:[Array],default:()=>[],required:!0},request:{type:Function,default:null,required:!0},rowKey:{type:[String,Function],default:void 0},pagination:{type:[Object,Boolean],default:()=>{}},showPagination:{type:[String,Boolean],default:"auto"}},Pe=[{type:"menu",label:"紧凑",key:"small"},{type:"menu",label:"默认",key:"medium"},{type:"menu",label:"宽松",key:"large"}];var Oe=g({components:{ReloadOutlined:p,ColumnHeightOutlined:f,SettingOutlined:m,DragOutlined:h,ColumnSetting:ae,QuestionCircleOutlined:j},props:s(s({},A.props),ze),emits:["fetch-success","fetch-error","update:checked-row-keys"],setup(e,{emit:t}){const n=k(null),a=k([]),o=k(),l=y((()=>s(s({},e),P(o)))),{getLoading:i,setLoading:u}=function(e){const t=k(P(e).loading);return R((()=>P(e).loading),(e=>{t.value=e})),{getLoading:y((()=>P(t))),setLoading:function(e){t.value=e}}}(l),{getPaginationInfo:g,getPagination:p,setPagination:f,setShowPagination:m,getShowPagination:h}=function(e){const t=k({}),n=k(!0),a=y((()=>{const{pagination:a}=P(e);return!(!P(n)||ee(a)&&!a)&&s(s({pageSize:ye,pageSizes:Se,showSizePicker:!0,showQuickJumper:!0},ee(a)?{}:a),P(t))}));return{getPagination:function(){return P(a)},getPaginationInfo:a,setShowPagination:function(e){return r(this,null,(function*(){n.value=e}))},getShowPagination:function(){return P(n)},setPagination:function(e){const n=P(a);t.value=s(s({},ee(n)?{}:n),e)}}}(l),{getDataSourceRef:b,getRowKey:O,getDataSource:w,setDataSource:_,reload:x}=function(e,{getPaginationInfo:t,setPagination:n,setLoading:a,tableData:o,getSelection:l},i){const c=k([]);C((()=>{o.value=P(c)})),R((()=>P(e).dataSource),(()=>{const{dataSource:t}=P(e);t&&(c.value=t)}),{immediate:!0});const u=y((()=>{const{rowKey:t}=P(e);return t||(()=>"key")})),d=y((()=>{const e=P(c);return e&&e.length,P(c)}));function g(o){return r(this,null,(function*(){try{a(!0);const{request:l,pagination:r}=P(e),u=Ce.pageField,d=Ce.sizeField,p=Ce.totalField,f=Ce.listField;let m={};const{page:h=1,pageSize:b=10}=P(t);ee(r)&&!r||ee(t)?m={}:(m[u]=o&&o[u]||h,m[d]=b);let k=s({},m);const v=yield l(k),y=v[p]||0,C=v[u];if(y){const e=Math.ceil(y/b);h>e&&(n({[u]:e}),g(o))}let S=v[f]?v[f]:[];c.value=S,n({[u]:C,[p]:y}),o&&o[u]&&n({[u]:o[u]||1}),i("fetch-success",{items:P(S),resultTotal:y})}catch(l){i("fetch-error",l),c.value=[]}finally{a(!1)}}))}return U((()=>{setTimeout((()=>{g()}),16)})),{fetch:g,getRowKey:u,getDataSourceRef:d,getDataSource:function(){return d.value},setTableData:function(e){c.value=e},reload:function(e){return r(this,null,(function*(){yield g(e)}))}}}(l,{getPaginationInfo:g,setPagination:f,tableData:a,setLoading:u},t),{getPageColumns:L,setColumns:T,getColumns:j,getCacheColumns:A,setCacheColumnsField:V,getColumnsRef:K}=function(e){const t=k(P(e).columns);let n=P(e).columns;const a=y((()=>D(P(t)))),o=y((()=>{const e=P(a);return D(e)}));return R((()=>P(e).columns),(e=>{var a;t.value=e,n=null!=(a=null==e?void 0:e.filter((e=>!e.flag)))?a:[]})),{getColumnsRef:a,getCacheColumns:function(e){return e?n.map((e=>e.key)):n},setCacheColumnsField:function(e,t){e&&t&&n.forEach((n=>{n.key!==e||Object.assign(n,t)}))},setColumns:function(e){const a=D(e);if(!G(a))return;if(!a.length)return void(t.value=[]);const o=n.map((e=>e.key));if(N(a[0])){const l=[];n.forEach((t=>{e.includes(t.key)&&l.push(s({},t))})),F(o,a)||l.sort(((e,t)=>o.indexOf(e.key)-o.indexOf(t.key))),t.value=l}else t.value=a},getColumns:function(){return z(P(e).columns).map((e=>({title:e.title,key:e.key,fixed:e.fixed||void 0})))},getPageColumns:o}}(l),q=v({tableSize:"medium",isColumnSetting:!1});const E=y((()=>q.tableSize)),I=y((()=>{const e=P(b);return c(s({},P(l)),{loading:P(i),columns:z(P(L)),rowKey:P(O),data:e,size:P(E),remote:!0})})),B=y((()=>z(P(g))));const $={reload:x,setColumns:T,setLoading:u,setProps:function(e){o.value=s(s({},P(o)),e)},getColumns:j,getPageColumns:L,getCacheColumns:A,setCacheColumnsField:V,emit:t,getSize:()=>P(I).size};var Q;return Q=c(s({},$),{wrapRef:n,getBindValues:I}),d(ne,Q),c(s({},S(q)),{getBindValues:I,densityOptions:Pe,reload:x,densitySelect:function(e){q.tableSize=e},updatePage:function(e){f({page:e}),x()},updatePageSize:function(e){f({page:1,pageSize:e}),x()},updateCheckedRowKeys:function(e){t("update:checked-row-keys",e)},pagination:B,resetColumns:()=>{columns.map((e=>{e.isShow=!0}))},tableAction:$})}});const we=M();V("data-v-02db46ee");const _e={class:"table-toolbar"},xe={key:0,class:"table-toolbar-left-title"},Le={class:"flex items-center table-toolbar-right"},Te=L("span",null,"刷新",-1),Re={class:"table-toolbar-right-icon"},De=L("span",null,"密度",-1),Fe={class:"s-table"};K();const Ue=we(((e,t,n,a,o,l)=>{const i=O("QuestionCircleOutlined"),s=O("n-icon"),c=O("n-tooltip"),r=O("n-space"),u=O("ReloadOutlined"),d=O("ColumnHeightOutlined"),g=O("n-dropdown"),p=O("ColumnSetting"),f=O("n-data-table");return w(),_(H,null,[L("div",_e,[L(r,{align:"center",class:"table-toolbar-left"},{default:we((()=>[e.title?(w(),_("div",xe,[T(q(e.title)+" ",1),e.titleTooltip?(w(),_(c,{key:0,trigger:"hover"},{trigger:we((()=>[L(s,{size:"18",class:"ml-1 cursor-pointer text-gray-400"},{default:we((()=>[L(i)])),_:1})])),default:we((()=>[T(" "+q(e.titleTooltip),1)])),_:1})):E("",!0)])):E("",!0),I(e.$slots,"tableTitle",{},void 0,!0)])),_:3}),L("div",Le,[I(e.$slots,"toolbar",{},void 0,!0),L(c,{trigger:"hover"},{trigger:we((()=>[L("div",{class:"table-toolbar-right-icon",onClick:t[1]||(t[1]=(...t)=>e.reload&&e.reload(...t))},[L(s,{size:"18"},{default:we((()=>[L(u)])),_:1})])])),default:we((()=>[Te])),_:1}),L(c,{trigger:"hover"},{trigger:we((()=>[L("div",Re,[L(g,{onSelect:e.densitySelect,trigger:"click",options:e.densityOptions,value:e.tableSize,"onUpdate:value":t[2]||(t[2]=t=>e.tableSize=t)},{default:we((()=>[L(s,{size:"18"},{default:we((()=>[L(d)])),_:1})])),_:1},8,["onSelect","options","value"])])])),default:we((()=>[De])),_:1}),L(p)])]),L("div",Fe,[L(f,B(e.getBindValues,{pagination:e.pagination,"onUpdate:page":e.updatePage,"onUpdate:pageSize":e.updatePageSize}),$({_:2},[Q(Object.keys(e.$slots),(t=>({name:t,fn:we((n=>[I(e.$slots,t,n,void 0,!0)]))})))]),1040,["pagination","onUpdate:page","onUpdate:pageSize"])])],64)}));Oe.render=Ue,Oe.__scopeId="data-v-02db46ee";const je=[{title:"id",key:"id"},{title:"名称",key:"name"},{title:"头像",key:"avatar",render:e=>X(J,{size:48,src:e.avatar})},{title:"地址",key:"address"},{title:"开始日期",key:"beginTime"},{title:"结束日期",key:"endTime"},{title:"创建时间",key:"date"},{title:"操作",key:"actions",render:e=>X(W,{size:"small",onClick:()=>{}},{default:()=>"编辑"})}];var Ae=g({components:{ProTable:Oe},setup(){Y();const e=k(),t=v({params:{pageSize:5,name:"xiaoMa"}});return c(s({},S(t)),{columns:je,actionRef:e,loadDataTable:e=>r(this,null,(function*(){return yield function(e){return te.request({url:"/table/list",method:"get",params:e})}(e)})),onCheckedRow:function(e){},reloadTable:function(){e.value.reload()}})}});const Ve=M();V("data-v-09cb895d");const Ke=T("刷新数据");K();const qe=Ve(((e,t,n,a,o,l)=>{const i=O("n-button"),s=O("ProTable"),c=O("n-card");return w(),_(c,{bordered:!1,class:"proCard"},{default:Ve((()=>[L(s,{title:"表格列表",titleTooltip:"这是一个提示",columns:e.columns,request:e.loadDataTable,"row-key":e=>e.id,ref:"actionRef","onUpdate:checkedRowKeys":e.onCheckedRow},{toolbar:Ve((()=>[L(i,{type:"primary",onClick:e.reloadTable},{default:Ve((()=>[Ke])),_:1},8,["onClick"])])),_:1},8,["columns","request","row-key","onUpdate:checkedRowKeys"])])),_:1})}));Ae.render=qe,Ae.__scopeId="data-v-09cb895d";export default Ae;
