var e=Object.defineProperty,t=Object.defineProperties,n=Object.getOwnPropertyDescriptors,a=Object.getOwnPropertySymbols,o=Object.prototype.hasOwnProperty,l=Object.prototype.propertyIsEnumerable,i=(t,n,a)=>n in t?e(t,n,{enumerable:!0,configurable:!0,writable:!0,value:a}):t[n]=a,s=(e,t)=>{for(var n in t||(t={}))o.call(t,n)&&i(e,n,t[n]);if(a)for(var n of a(t))l.call(t,n)&&i(e,n,t[n]);return e},c=(e,a)=>t(e,n(a)),r=(e,t,n)=>new Promise(((a,o)=>{var l=e=>{try{s(n.next(e))}catch(t){o(t)}},i=e=>{try{s(n.throw(e))}catch(t){o(t)}},s=e=>e.done?a(e.value):Promise.resolve(e.value).then(l,i);s((n=n.apply(e,t)).next())}));import{b1 as u,b2 as d,d as g,b3 as p,b4 as f,b5 as m,b6 as b,b7 as h,b8 as k,f as y,j as v,k as C,b9 as S,i as z,u as O,x as P,Q as w,o as x,c as _,X as L,b as D,b0 as R,ba as T,q as F,bb as j,g as U,bc as V,aL as A,p as q,a as E,t as I,R as K,Y as B,bd as Q,be as $,r as H,F as M,e as J,s as X,ap as Y,a9 as G,T as N}from"./vendor.1641eb33.js";import{d as W,u as Z}from"./useDesignSetting.c121c1ec.js";import{i as ee,a as te,b as ne,A as ae}from"./index.4b7442c2.js";const oe=Symbol("s-table");var le=g({name:"ColumnSetting",components:{ReloadOutlined:p,ColumnHeightOutlined:f,SettingOutlined:m,DragOutlined:b,Draggable:W,VerticalRightOutlined:h,VerticalLeftOutlined:k},setup(e,{emit:t}){const{getDarkTheme:n}=Z(),a=u(oe),o=y([]),l=y([]),i=v({selection:!1,checkAll:!0,checkList:[],defaultCheckList:[]}),r=C((()=>i.selection));function d(e){a.setColumns(e)}function g(){let e=[];return a.getColumns().forEach((t=>{e.push(s({},t))})),e}return S((()=>{a.getColumns().length&&function(){const e=g(),t=e.map((e=>e.key));i.checkList=t,i.defaultCheckList=t,o.value=e,l.value=e}()})),c(s({},z(i)),{columnsList:o,getDarkTheme:n,onChange:function(e){i.selection&&e.unshift("selection"),d(e)},onCheckAll:function(e){let t=a.getCacheColumns(!0);e?(d(t),i.checkList=t):(d([]),i.checkList=[])},onSelection:function(e){let t=a.getCacheColumns();e?(t.unshift({type:"selection",key:"selection"}),d(t)):(t.splice(0,1),d(t))},resetColumns:function(){i.checkList=[...i.defaultCheckList],i.checkAll=!0;let e=a.getCacheColumns().map((e=>c(s({},e),{fixed:void 0})));d(e),o.value=e},fixedColumn:function(e,t){if(!i.checkList.includes(e.key))return;let n=g();const l=e.fixed===t?void 0:t;let s=n.findIndex((t=>t.key===e.key));-1!==s&&(n[s].fixed=l),a.setCacheColumnsField(e.key,{fixed:l}),o.value[s].fixed=l,d(n)},draggableEnd:function(){const e=O(P(o));o.value=e,d(e)},getSelection:r})}});const ie={class:"cursor-pointer table-toolbar-right-icon"},se={class:"table-toolbar-inner-popover-title"},ce=R("列展示"),re=R("勾选列"),ue=R("重置"),de={class:"table-toolbar-inner"},ge={class:"drag-icon"},pe={class:"fixed-item"},fe=D("span",null,"固定到左侧",-1),me=D("span",null,"固定到右侧",-1),be=D("span",null,"列设置",-1);le.render=function(e,t,n,a,o,l){const i=w("SettingOutlined"),s=w("n-icon"),c=w("n-checkbox"),r=w("n-button"),u=w("n-space"),d=w("DragOutlined"),g=w("VerticalRightOutlined"),p=w("n-tooltip"),f=w("n-divider"),m=w("VerticalLeftOutlined"),b=w("Draggable"),h=w("n-checkbox-group"),k=w("n-popover");return x(),_(p,{trigger:"hover"},{trigger:L((()=>[D("div",ie,[D(k,{trigger:"click",width:230,class:"toolbar-popover",placement:"bottom-end"},{trigger:L((()=>[D(s,{size:"18"},{default:L((()=>[D(i)])),_:1})])),header:L((()=>[D("div",se,[D(u,null,{default:L((()=>[D(c,{checked:e.checkAll,"onUpdate:checked":[t[1]||(t[1]=t=>e.checkAll=t),e.onCheckAll]},{default:L((()=>[ce])),_:1},8,["checked","onUpdate:checked"]),D(c,{checked:e.selection,"onUpdate:checked":[t[2]||(t[2]=t=>e.selection=t),e.onSelection]},{default:L((()=>[re])),_:1},8,["checked","onUpdate:checked"]),D(r,{text:"",type:"info",size:"small",class:"mt-1",onClick:e.resetColumns},{default:L((()=>[ue])),_:1},8,["onClick"])])),_:1})])])),default:L((()=>[D("div",de,[D(h,{value:e.checkList,"onUpdate:value":[t[4]||(t[4]=t=>e.checkList=t),e.onChange]},{default:L((()=>[D(b,{modelValue:e.columnsList,"onUpdate:modelValue":t[3]||(t[3]=t=>e.columnsList=t),animation:"300","item-key":"key",onEnd:e.draggableEnd},{item:L((({element:t,index:n})=>[D("div",{class:["table-toolbar-inner-checkbox",{"table-toolbar-inner-checkbox-dark":!0===e.getDarkTheme}]},[D("span",ge,[D(s,{size:"18"},{default:L((()=>[D(d)])),_:1})]),D(c,{value:t.key,label:t.title},null,8,["value","label"]),D("div",pe,[D(p,{trigger:"hover",placement:"bottom"},{trigger:L((()=>[D(s,{size:"18",color:"left"===t.fixed?"#2080f0":void 0,class:"cursor-pointer",onClick:n=>e.fixedColumn(t,"left")},{default:L((()=>[D(g)])),_:2},1032,["color","onClick"])])),default:L((()=>[fe])),_:2},1024),D(f,{vertical:""}),D(p,{trigger:"hover",placement:"bottom"},{trigger:L((()=>[D(s,{size:"18",color:"right"===t.fixed?"#2080f0":void 0,class:"cursor-pointer",onClick:n=>e.fixedColumn(t,"right")},{default:L((()=>[D(m)])),_:2},1032,["color","onClick"])])),default:L((()=>[me])),_:2},1024)])],2)])),_:1},8,["modelValue","onEnd"])])),_:1},8,["value","onUpdate:value"])])])),_:1})])])),default:L((()=>[be])),_:1})};const{table:he}={table:{apiSetting:{pageField:"page",sizeField:"pageSize",listField:"list",totalField:"pageCount"},defaultPageSize:10,pageSizes:[10,20,30,40,50]}},{apiSetting:ke,defaultPageSize:ye,pageSizes:ve}=he,Ce=ye,Se=ke,ze=ve;const Oe={title:{type:String,default:null},titleTooltip:{type:String,default:null},size:{type:String,default:"medium"},tableData:{type:[Object],default:()=>{}},columns:{type:[Array],default:()=>[],required:!0},request:{type:Function,default:null,required:!0},rowKey:{type:[String,Function],default:void 0},pagination:{type:[Object,Boolean],default:()=>{}},showPagination:{type:[String,Boolean],default:"auto"}},Pe=[{type:"menu",label:"紧凑",key:"small"},{type:"menu",label:"默认",key:"medium"},{type:"menu",label:"宽松",key:"large"}];var we=g({components:{ReloadOutlined:p,ColumnHeightOutlined:f,SettingOutlined:m,DragOutlined:b,ColumnSetting:le,QuestionCircleOutlined:V},props:s(s({},A.props),Oe),emits:["fetch-success","fetch-error","update:checked-row-keys"],setup(e,{emit:t}){const n=y(null),a=y([]),o=y(),l=C((()=>s(s({},e),P(o)))),{getLoading:i,setLoading:u}=function(e){const t=y(P(e).loading);return T((()=>P(e).loading),(e=>{t.value=e})),{getLoading:C((()=>P(t))),setLoading:function(e){t.value=e}}}(l),{getPaginationInfo:g,getPagination:p,setPagination:f,setShowPagination:m,getShowPagination:b}=function(e){const t=y({}),n=y(!0),a=C((()=>{const{pagination:a}=P(e);return!(!P(n)||ne(a)&&!a)&&s(s({pageSize:Ce,pageSizes:ze,showSizePicker:!0,showQuickJumper:!0},ne(a)?{}:a),P(t))}));return{getPagination:function(){return P(a)},getPaginationInfo:a,setShowPagination:function(e){return r(this,null,(function*(){n.value=e}))},getShowPagination:function(){return P(n)},setPagination:function(e){const n=P(a);t.value=s(s({},ne(n)?{}:n),e)}}}(l),{getDataSourceRef:h,getRowKey:k,getDataSource:w,setDataSource:x,reload:_}=function(e,{getPaginationInfo:t,setPagination:n,setLoading:a,tableData:o},l){const i=y([]);S((()=>{o.value=P(i)})),T((()=>P(e).dataSource),(()=>{const{dataSource:t}=P(e);t&&(i.value=t)}),{immediate:!0});const c=C((()=>{const{rowKey:t}=P(e);return t||(()=>"key")})),u=C((()=>{const e=P(i);return e&&e.length,P(i)}));function d(o){return r(this,null,(function*(){try{a(!0);const{request:c,pagination:r}=P(e),u=Se.pageField,g=Se.sizeField,p=Se.totalField,f=Se.listField;let m={};const{page:b=1,pageSize:h=10}=P(t);ne(r)&&!r||ne(t)?m={}:(m[u]=o&&o[u]||b,m[g]=h);let k=s({},m);const y=yield c(k),v=y[p]||0,C=y[u];if(v){const e=Math.ceil(v/h);b>e&&(n({[u]:e}),d(o))}let S=y[f]?y[f]:[];i.value=S,n({[u]:C,[p]:v}),o&&o[u]&&n({[u]:o[u]||1}),l("fetch-success",{items:P(S),resultTotal:v})}catch(c){l("fetch-error",c),i.value=[]}finally{a(!1)}}))}return U((()=>{setTimeout((()=>{d()}),16)})),{fetch:d,getRowKey:c,getDataSourceRef:u,getDataSource:function(){return u.value},setTableData:function(e){i.value=e},reload:function(e){return r(this,null,(function*(){yield d(e)}))}}}(l,{getPaginationInfo:g,setPagination:f,tableData:a,setLoading:u},t),{getPageColumns:L,setColumns:D,getColumns:R,getCacheColumns:V,setCacheColumnsField:A,getColumnsRef:q}=function(e){const t=y(P(e).columns);let n=P(e).columns;const a=C((()=>F(P(t)))),o=C((()=>{const e=P(a);return F(e)}));return T((()=>P(e).columns),(e=>{t.value=e,n=e})),{getColumnsRef:a,getCacheColumns:function(e){return e?n.map((e=>e.key)):n},setCacheColumnsField:function(e,t){e&&t&&n.forEach((n=>{n.key!==e||Object.assign(n,t)}))},setColumns:function(e){const a=F(e);if(!ee(a))return;if(!a.length)return void(t.value=[]);const o=n.map((e=>e.key));if(te(a[0])){const l=[];n.forEach((t=>{e.includes(t.key)&&l.push(s({},t))})),j(o,a)||l.sort(((e,t)=>o.indexOf(e.key)-o.indexOf(t.key))),t.value=l}else t.value=a},getColumns:function(){return O(P(a)).map((e=>c(s({},e),{title:e.title,key:e.key,fixed:e.fixed||void 0})))},getPageColumns:o}}(l),E=v({tableSize:"medium",isColumnSetting:!1});const I=C((()=>E.tableSize)),K=C((()=>{const e=P(h);return c(s({},P(l)),{loading:P(i),columns:O(P(L)),rowKey:P(k),data:e,size:P(I),remote:!0})})),B=C((()=>O(P(g))));const Q={reload:_,setColumns:D,setLoading:u,setProps:function(e){o.value=s(s({},P(o)),e)},getColumns:R,getPageColumns:L,getCacheColumns:V,setCacheColumnsField:A,emit:t,getSize:()=>P(K).size};var $;return $=c(s({},Q),{wrapRef:n,getBindValues:K}),d(oe,$),c(s({},z(E)),{getBindValues:K,densityOptions:Pe,reload:_,densitySelect:function(e){E.tableSize=e},updatePage:function(e){f({page:e}),_()},updatePageSize:function(e){f({page:1,pageSize:e}),_()},updateCheckedRowKeys:function(e){t("update:checked-row-keys",e)},pagination:B,resetColumns:()=>{columns.map((e=>{e.isShow=!0}))},tableAction:Q})}});const xe=J();q("data-v-5952b99a");const _e={class:"table-toolbar"},Le={key:0,class:"table-toolbar-left-title"},De={class:"flex items-center table-toolbar-right"},Re=D("span",null,"刷新",-1),Te={class:"table-toolbar-right-icon"},Fe=D("span",null,"密度",-1),je={class:"s-table"};E();const Ue=xe(((e,t,n,a,o,l)=>{const i=w("QuestionCircleOutlined"),s=w("n-icon"),c=w("n-tooltip"),r=w("n-space"),u=w("ReloadOutlined"),d=w("ColumnHeightOutlined"),g=w("n-dropdown"),p=w("ColumnSetting"),f=w("n-data-table");return x(),_(M,null,[D("div",_e,[D(r,{align:"center",class:"table-toolbar-left"},{default:xe((()=>[e.title?(x(),_("div",Le,[R(I(e.title)+" ",1),e.titleTooltip?(x(),_(c,{key:0,trigger:"hover"},{trigger:xe((()=>[D(s,{size:"18",class:"ml-1 cursor-pointer text-gray-400"},{default:xe((()=>[D(i)])),_:1})])),default:xe((()=>[R(" "+I(e.titleTooltip),1)])),_:1})):K("",!0)])):K("",!0),B(e.$slots,"tableTitle",{},void 0,!0)])),_:3}),D("div",De,[B(e.$slots,"toolbar",{},void 0,!0),D(c,{trigger:"hover"},{trigger:xe((()=>[D("div",{class:"table-toolbar-right-icon",onClick:t[1]||(t[1]=(...t)=>e.reload&&e.reload(...t))},[D(s,{size:"18"},{default:xe((()=>[D(u)])),_:1})])])),default:xe((()=>[Re])),_:1}),D(c,{trigger:"hover"},{trigger:xe((()=>[D("div",Te,[D(g,{onSelect:e.densitySelect,trigger:"click",options:e.densityOptions,value:e.tableSize,"onUpdate:value":t[2]||(t[2]=t=>e.tableSize=t)},{default:xe((()=>[D(s,{size:"18"},{default:xe((()=>[D(d)])),_:1})])),_:1},8,["onSelect","options","value"])])])),default:xe((()=>[Fe])),_:1}),D(p)])]),D("div",je,[D(f,Q(e.getBindValues,{pagination:e.pagination,"onUpdate:page":e.updatePage,"onUpdate:pageSize":e.updatePageSize}),$({_:2},[H(Object.keys(e.$slots),(t=>({name:t,fn:xe((n=>[B(e.$slots,t,n,void 0,!0)]))})))]),1040,["pagination","onUpdate:page","onUpdate:pageSize"])])],64)}));we.render=Ue,we.__scopeId="data-v-5952b99a";const Ve=[{title:"id",key:"id"},{title:"名称",key:"name"},{title:"头像",key:"avatar",render:e=>X(Y,{size:48,src:e.avatar})},{title:"地址",key:"address"},{title:"开始日期",key:"beginTime"},{title:"结束日期",key:"endTime"},{title:"创建时间",key:"date"},{title:"操作",key:"actions",render:e=>X(G,{size:"small",onClick:()=>{}},{default:()=>"编辑"})}];var Ae=g({components:{ProTable:we},setup(){N();const e=y(),t=v({params:{pageSize:5,name:"xiaoMa"}});return c(s({},z(t)),{columns:Ve,actionRef:e,loadDataTable:e=>r(this,null,(function*(){return yield function(e){return ae.request({url:"/table/list",method:"get",params:e})}(e)})),onCheckedRow:function(e){},reloadTable:function(){e.value.reload()}})}});const qe=J();q("data-v-09cb895d");const Ee=R("刷新数据");E();const Ie=qe(((e,t,n,a,o,l)=>{const i=w("n-button"),s=w("ProTable"),c=w("n-card");return x(),_(c,{bordered:!1,class:"proCard"},{default:qe((()=>[D(s,{title:"表格列表",titleTooltip:"这是一个提示",columns:e.columns,request:e.loadDataTable,"row-key":e=>e.id,ref:"actionRef","onUpdate:checkedRowKeys":e.onCheckedRow},{toolbar:qe((()=>[D(i,{type:"primary",onClick:e.reloadTable},{default:qe((()=>[Ee])),_:1},8,["onClick"])])),_:1},8,["columns","request","row-key","onUpdate:checkedRowKeys"])])),_:1})}));Ae.render=Ie,Ae.__scopeId="data-v-09cb895d";export default Ae;
