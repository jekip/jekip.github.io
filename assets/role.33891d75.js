var e=Object.defineProperty,t=Object.defineProperties,a=Object.getOwnPropertyDescriptors,n=Object.getOwnPropertySymbols,l=Object.prototype.hasOwnProperty,o=Object.prototype.propertyIsEnumerable,i=(t,a,n)=>a in t?e(t,a,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[a]=n,c=(e,t,a)=>new Promise(((n,l)=>{var o=e=>{try{c(a.next(e))}catch(t){l(t)}},i=e=>{try{c(a.throw(e))}catch(t){l(t)}},c=e=>e.done?n(e.value):Promise.resolve(e.value).then(o,i);c((a=a.apply(e,t)).next())}));import{_ as s,a as d}from"./TableAction.2247acc0.js";import{A as r,j as u,l as f}from"./index.6e96d14c.js";import{s as p,aH as h,d as m,bG as y,f as k,Y as b,j as g,g as w,i as v,Q as x,o as K,c as C,b as T,a2 as _,be as j,t as D}from"./vendor.4f18afb7.js";import"./useDesignSetting.a2f309c9.js";import"./componentSetting.df76d574.js";import"./index.esm.0f090ea5.js";const A=[{title:"id",key:"id"},{title:"角色名称",key:"name"},{title:"说明",key:"explain"},{title:"是否默认角色",key:"isDefault",render:e=>p(h,{type:e.isDefault?"success":"error"},{default:()=>e.isDefault?"是":"否"})},{title:"创建时间",key:"create_date"}],O={name:{required:!0,trigger:["blur","input"],message:"请输入名称"},address:{required:!0,trigger:["blur","input"],message:"请输入地址"},date:{type:"number",required:!0,trigger:["blur","change"],message:"请选择日期"}};var P=m({components:{BasicTable:s,TableAction:d,PlusOutlined:y},setup(){const e=k(null),s=b(),h=k(),m=g({showModal:!1,formBtnLoading:!1,checkedAll:!1,editRoleTitle:"",treeData:[],expandedKeys:[],checkedKeys:["console","step-form"],formParams:{name:"",address:"",date:[]},params:{pageSize:5,name:"xiaoMa"},actionColumn:{width:250,title:"操作",dataIndex:"action",fixed:"right",render:e=>p(d,{style:"button",actions:[{label:"菜单权限",onClick:C.bind(null,e),ifShow:()=>!0,auth:["basic_list"]},{label:"编辑",onClick:x.bind(null,e),ifShow:()=>!0,auth:["basic_list"]},{label:"删除",icon:"ic:outline-delete-outline",onClick:K.bind(null,e),ifShow:()=>!0,auth:["basic_list"]}]})}});function y(){h.value.reload()}function x(e){router.push({name:"basic-info",params:{id:e.id}})}function K(e){s.info("点击了删除")}function C(e){m.editRoleTitle=`分配 ${e.name} 的菜单权限`,m.checkedKeys=e.menu_keys,m.showModal=!0}return w((()=>c(this,null,(function*(){const e=yield u();m.expandedKeys=e.list.map((e=>e.key)),m.treeData=e.list})))),T=((e,t)=>{for(var a in t||(t={}))l.call(t,a)&&i(e,a,t[a]);if(n)for(var a of n(t))o.call(t,a)&&i(e,a,t[a]);return e})({},v(m)),t(T,a({formRef:e,columns:A,rules:O,actionRef:h,confirmForm:function(t){t.preventDefault(),m.formBtnLoading=!0,e.value.validate((e=>{e?s.error("请填写完整信息"):(s.success("新建成功"),setTimeout((()=>{m.showModal=!1,y()}))),m.formBtnLoading=!1}))},loadDataTable:e=>c(this,null,(function*(){return yield r.request({url:"/role/list",method:"GET"})})),onCheckedRow:function(e){},reloadTable:y,handleEdit:x,handleDelete:K,handleOpen:function(e){s.info("点击了删除")},handleMenuAuth:C,checkedTree:function(e){m.checkedKeys=[m.checkedKeys,...e]},packHandle:function(){m.expandedKeys.length?m.expandedKeys=[]:m.expandedKeys=m.treeData.map((e=>e.key))},checkedAllHandle:function(){m.checkedAll?(m.checkedKeys=[],m.checkedAll=!1):(m.checkedKeys=f(m.treeData),m.checkedAll=!0)}}));var T}});const R={class:"n-layout-page-header"},M=j(" 页面数据为 Mock 示例数据，非真实数据。 "),S=j(" 添加角色 "),q={class:"py-3 menu-list"},B=j("提交");P.render=function(e,t,a,n,l,o){const i=x("n-card"),c=x("PlusOutlined"),s=x("n-icon"),d=x("n-button"),r=x("TableAction"),u=x("BasicTable"),f=x("n-tree"),p=x("n-space"),h=x("n-modal");return K(),C("div",null,[T("div",R,[T(i,{bordered:!1,title:"角色权限管理"},{default:_((()=>[M])),_:1})]),T(i,{bordered:!1,class:"mt-4 proCard"},{default:_((()=>[T(u,{columns:e.columns,request:e.loadDataTable,"row-key":e=>e.id,ref:"actionRef",actionColumn:e.actionColumn,"onUpdate:checkedRowKeys":e.onCheckedRow},{tableTitle:_((()=>[T(d,{type:"primary"},{icon:_((()=>[T(s,null,{default:_((()=>[T(c)])),_:1})])),default:_((()=>[S])),_:1})])),action:_((()=>[T(r)])),_:1},8,["columns","request","row-key","actionColumn","onUpdate:checkedRowKeys"])])),_:1}),T(h,{show:e.showModal,"onUpdate:show":t[1]||(t[1]=t=>e.showModal=t),"show-icon":!1,preset:"dialog",title:e.editRoleTitle},{action:_((()=>[T(p,null,{default:_((()=>[T(d,{type:"info",ghost:"","icon-placement":"left",onClick:e.packHandle},{default:_((()=>[j(" 全部"+D(e.expandedKeys.length?"收起":"展开"),1)])),_:1},8,["onClick"]),T(d,{type:"info",ghost:"","icon-placement":"left",onClick:e.checkedAllHandle},{default:_((()=>[j(" 全部"+D(e.checkedAll?"取消":"选择"),1)])),_:1},8,["onClick"]),T(d,{type:"primary",loading:e.formBtnLoading,onClick:e.confirmForm},{default:_((()=>[B])),_:1},8,["loading","onClick"])])),_:1})])),default:_((()=>[T("div",q,[T(f,{"block-line":"",cascade:"",checkable:"","virtual-scroll":!0,data:e.treeData,expandedKeys:e.expandedKeys,"checked-keys":e.checkedKeys,style:{"max-height":"950px",overflow:"hidden"},"onUpdate:checkedKeys":e.checkedTree},null,8,["data","expandedKeys","checked-keys","onUpdate:checkedKeys"])])])),_:1},8,["show","title"])])};export default P;
