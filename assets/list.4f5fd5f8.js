var e=Object.defineProperty,t=Object.defineProperties,a=Object.getOwnPropertyDescriptors,n=Object.getOwnPropertySymbols,o=Object.prototype.hasOwnProperty,l=Object.prototype.propertyIsEnumerable,i=(t,a,n)=>a in t?e(t,a,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[a]=n,s=(e,t)=>{for(var a in t||(t={}))o.call(t,a)&&i(e,a,t[a]);if(n)for(var a of n(t))l.call(t,a)&&i(e,a,t[a]);return e},c=(e,n)=>t(e,a(n)),r=(e,t,a)=>new Promise(((n,o)=>{var l=e=>{try{s(a.next(e))}catch(t){o(t)}},i=e=>{try{s(a.throw(e))}catch(t){o(t)}},s=e=>e.done?n(e.value):Promise.resolve(e.value).then(l,i);s((a=a.apply(e,t)).next())}));import{aS as u,aT as d,d as g,aU as p,aV as f,aW as m,aX as h,aY as b,f as k,j as y,k as v,aZ as C,i as S,u as z,x as P,O,o as w,c as _,V as x,b as T,aR as D,a_ as L,q as R,a$ as F,g as U,b0 as j,aK as A,p as V,a as K,t as q,Q as E,X as I,b1 as B,b2 as $,r as Q,F as H,e as M,s as X,ao as J,a8 as W,S as Y}from"./vendor.d43c22c4.js";import{d as Z,u as G}from"./useDesignSetting.7ad3bba2.js";import{i as N,a as ee,b as te,A as ae}from"./index.e871fa7d.js";const ne=Symbol("s-table");var oe=g({name:"ColumnSetting",components:{ReloadOutlined:p,ColumnHeightOutlined:f,SettingOutlined:m,DragOutlined:h,Draggable:Z,VerticalAlignTopOutlined:b},setup(e,{emit:t}){const{getDarkTheme:a}=G(),n=u(ne),o=k([]),l=k([]),i=y({selection:!1,checkAll:!0,checkList:[],defaultCheckList:[]}),r=v((()=>i.selection));function d(e){n.setColumns(e)}function g(){let e=[];return n.getColumns().forEach((t=>{e.push(s({},t))})),e}return C((()=>{n.getColumns().length&&function(){const e=g(),t=e.map((e=>e.key));i.checkList=t,i.defaultCheckList=t,o.value=e,l.value=e}()})),c(s({},S(i)),{columnsList:o,getDarkTheme:a,onChange:function(e){i.selection&&e.unshift("selection"),d(e)},onCheckAll:function(e){let t=n.getCacheColumns(!0);e?(d(t),i.checkList=t):(d([]),i.checkList=[])},onSelection:function(e){let t=n.getCacheColumns();e?(t.unshift({type:"selection",key:"selection"}),d(t)):(t.splice(0,1),d(t))},resetColumns:function(){i.checkList=[...i.defaultCheckList],i.checkAll=!0;let e=n.getCacheColumns().map((e=>c(s({},e),{fixed:void 0})));d(e),o.value=e},fixedColumn:function(e,t){if(!i.checkList.includes(e.key))return;let a=g();const l=e.fixed===t?void 0:t;let s=a.findIndex((t=>t.key===e.key));-1!==s&&(a[s].fixed=l),n.setCacheColumnsField(e.key,{fixed:l}),o.value[s].fixed=l,d(a)},draggableEnd:function(){const e=z(P(o));o.value=e,d(e)},getSelection:r})}});const le={class:"cursor-pointer table-toolbar-right-icon"},ie={class:"table-toolbar-inner-popover-title"},se=D("列展示"),ce=D("勾选列"),re=D("重置"),ue={class:"table-toolbar-inner"},de={class:"drag-icon"},ge={class:"fixed-item"},pe=T("span",null,"固定到左侧",-1),fe=T("span",null,"固定到右侧",-1),me=T("span",null,"列设置",-1);oe.render=function(e,t,a,n,o,l){const i=O("SettingOutlined"),s=O("n-icon"),c=O("n-checkbox"),r=O("n-button"),u=O("n-space"),d=O("DragOutlined"),g=O("VerticalAlignTopOutlined"),p=O("n-tooltip"),f=O("n-divider"),m=O("Draggable"),h=O("n-checkbox-group"),b=O("n-popover");return w(),_(p,{trigger:"hover"},{trigger:x((()=>[T("div",le,[T(b,{trigger:"click",width:230,class:"toolbar-popover",placement:"bottom-end"},{trigger:x((()=>[T(s,{size:"18"},{default:x((()=>[T(i)])),_:1})])),header:x((()=>[T("div",ie,[T(u,null,{default:x((()=>[T(c,{checked:e.checkAll,"onUpdate:checked":[t[1]||(t[1]=t=>e.checkAll=t),e.onCheckAll]},{default:x((()=>[se])),_:1},8,["checked","onUpdate:checked"]),T(c,{checked:e.selection,"onUpdate:checked":[t[2]||(t[2]=t=>e.selection=t),e.onSelection]},{default:x((()=>[ce])),_:1},8,["checked","onUpdate:checked"]),T(r,{text:"",type:"info",size:"small",class:"mt-1",onClick:e.resetColumns},{default:x((()=>[re])),_:1},8,["onClick"])])),_:1})])])),default:x((()=>[T("div",ue,[T(h,{value:e.checkList,"onUpdate:value":[t[4]||(t[4]=t=>e.checkList=t),e.onChange]},{default:x((()=>[T(m,{modelValue:e.columnsList,"onUpdate:modelValue":t[3]||(t[3]=t=>e.columnsList=t),animation:"300","item-key":"key",onEnd:e.draggableEnd},{item:x((({element:t,index:a})=>[T("div",{class:["table-toolbar-inner-checkbox",{"table-toolbar-inner-checkbox-dark":!0===e.getDarkTheme}]},[T("span",de,[T(s,{size:"18"},{default:x((()=>[T(d)])),_:1})]),T(c,{value:t.key,label:t.title},null,8,["value","label"]),T("div",ge,[T(p,{trigger:"hover",placement:"bottom"},{trigger:x((()=>[T(s,{size:"18",color:"left"===t.fixed?"#2080f0":void 0,class:"transform -rotate-90 cursor-pointer",onClick:a=>e.fixedColumn(t,"left")},{default:x((()=>[T(g)])),_:2},1032,["color","onClick"])])),default:x((()=>[pe])),_:2},1024),T(f,{vertical:""}),T(p,{trigger:"hover",placement:"bottom"},{trigger:x((()=>[T(s,{size:"18",color:"right"===t.fixed?"#2080f0":void 0,class:"transform rotate-90 cursor-pointer",onClick:a=>e.fixedColumn(t,"right")},{default:x((()=>[T(g)])),_:2},1032,["color","onClick"])])),default:x((()=>[fe])),_:2},1024)])],2)])),_:1},8,["modelValue","onEnd"])])),_:1},8,["value","onUpdate:value"])])])),_:1})])])),default:x((()=>[me])),_:1})};const{table:he}={table:{apiSetting:{pageField:"page",sizeField:"pageSize",listField:"list",totalField:"pageCount"},defaultPageSize:10,pageSizes:[10,20,30,40,50]}},{apiSetting:be,defaultPageSize:ke,pageSizes:ye}=he,ve=ke,Ce=be,Se=ye;const ze={title:{type:String,default:null},titleTooltip:{type:String,default:null},size:{type:String,default:"medium"},tableData:{type:[Object],default:()=>{}},columns:{type:[Array],default:()=>[],required:!0},request:{type:Function,default:null,required:!0},rowKey:{type:[String,Function],default:void 0},pagination:{type:[Object,Boolean],default:()=>{}},showPagination:{type:[String,Boolean],default:"auto"}},Pe=[{type:"menu",label:"紧凑",key:"small"},{type:"menu",label:"默认",key:"medium"},{type:"menu",label:"宽松",key:"large"}];var Oe=g({components:{ReloadOutlined:p,ColumnHeightOutlined:f,SettingOutlined:m,DragOutlined:h,ColumnSetting:oe,QuestionCircleOutlined:j},props:s(s({},A.props),ze),emits:["fetch-success","fetch-error","update:checked-row-keys"],setup(e,{emit:t}){const a=k(null),n=k([]),o=k(),l=v((()=>s(s({},e),P(o)))),{getLoading:i,setLoading:u}=function(e){const t=k(P(e).loading);return L((()=>P(e).loading),(e=>{t.value=e})),{getLoading:v((()=>P(t))),setLoading:function(e){t.value=e}}}(l),{getPaginationInfo:g,getPagination:p,setPagination:f,setShowPagination:m,getShowPagination:h}=function(e){const t=k({}),a=k(!0),n=v((()=>{const{pagination:n}=P(e);return!(!P(a)||te(n)&&!n)&&s(s({pageSize:ve,pageSizes:Se,showSizePicker:!0,showQuickJumper:!0},te(n)?{}:n),P(t))}));return{getPagination:function(){return P(n)},getPaginationInfo:n,setShowPagination:function(e){return r(this,null,(function*(){a.value=e}))},getShowPagination:function(){return P(a)},setPagination:function(e){const a=P(n);t.value=s(s({},te(a)?{}:a),e)}}}(l),{getDataSourceRef:b,getRowKey:O,getDataSource:w,setDataSource:_,reload:x}=function(e,{getPaginationInfo:t,setPagination:a,setLoading:n,tableData:o},l){const i=k([]);C((()=>{o.value=P(i)})),L((()=>P(e).dataSource),(()=>{const{dataSource:t}=P(e);t&&(i.value=t)}),{immediate:!0});const c=v((()=>{const{rowKey:t}=P(e);return t||(()=>"key")})),u=v((()=>{const e=P(i);return e&&e.length,P(i)}));function d(o){return r(this,null,(function*(){try{n(!0);const{request:c,pagination:r}=P(e),u=Ce.pageField,g=Ce.sizeField,p=Ce.totalField,f=Ce.listField;let m={};const{page:h=1,pageSize:b=10}=P(t);te(r)&&!r||te(t)?m={}:(m[u]=o&&o[u]||h,m[g]=b);let k=s({},m);const y=yield c(k),v=y[p]||0,C=y[u];if(v){const e=Math.ceil(v/b);h>e&&(a({[u]:e}),d(o))}let S=y[f]?y[f]:[];i.value=S,a({[u]:C,[p]:v}),o&&o[u]&&a({[u]:o[u]||1}),l("fetch-success",{items:P(S),resultTotal:v})}catch(c){l("fetch-error",c),i.value=[]}finally{n(!1)}}))}return U((()=>{setTimeout((()=>{d()}),16)})),{fetch:d,getRowKey:c,getDataSourceRef:u,getDataSource:function(){return u.value},setTableData:function(e){i.value=e},reload:function(e){return r(this,null,(function*(){yield d(e)}))}}}(l,{getPaginationInfo:g,setPagination:f,tableData:n,setLoading:u},t),{getPageColumns:T,setColumns:D,getColumns:j,getCacheColumns:A,setCacheColumnsField:V,getColumnsRef:K}=function(e){const t=k(P(e).columns);let a=P(e).columns;const n=v((()=>R(P(t)))),o=v((()=>{const e=P(n);return R(e)}));return L((()=>P(e).columns),(e=>{t.value=e,a=e})),{getColumnsRef:n,getCacheColumns:function(e){return e?a.map((e=>e.key)):a},setCacheColumnsField:function(e,t){e&&t&&a.forEach((a=>{a.key!==e||Object.assign(a,t)}))},setColumns:function(e){const n=R(e);if(!N(n))return;if(!n.length)return void(t.value=[]);const o=a.map((e=>e.key));if(ee(n[0])){const l=[];a.forEach((t=>{e.includes(t.key)&&l.push(s({},t))})),F(o,n)||l.sort(((e,t)=>o.indexOf(e.key)-o.indexOf(t.key))),t.value=l}else t.value=n},getColumns:function(){return z(P(n)).map((e=>c(s({},e),{title:e.title,key:e.key,fixed:e.fixed||void 0})))},getPageColumns:o}}(l),q=y({tableSize:"medium",isColumnSetting:!1});const E=v((()=>q.tableSize)),I=v((()=>{const e=P(b);return c(s({},P(l)),{loading:P(i),columns:z(P(T)),rowKey:P(O),data:e,size:P(E),remote:!0})})),B=v((()=>z(P(g))));const $={reload:x,setColumns:D,setLoading:u,setProps:function(e){o.value=s(s({},P(o)),e)},getColumns:j,getPageColumns:T,getCacheColumns:A,setCacheColumnsField:V,emit:t,getSize:()=>P(I).size};var Q;return Q=c(s({},$),{wrapRef:a,getBindValues:I}),d(ne,Q),c(s({},S(q)),{getBindValues:I,densityOptions:Pe,reload:x,densitySelect:function(e){q.tableSize=e},updatePage:function(e){f({page:e}),x()},updatePageSize:function(e){f({page:1,pageSize:e}),x()},updateCheckedRowKeys:function(e){t("update:checked-row-keys",e)},pagination:B,resetColumns:()=>{columns.map((e=>{e.isShow=!0}))},tableAction:$})}});const we=M();V("data-v-5952b99a");const _e={class:"table-toolbar"},xe={key:0,class:"table-toolbar-left-title"},Te={class:"flex items-center table-toolbar-right"},De=T("span",null,"刷新",-1),Le={class:"table-toolbar-right-icon"},Re=T("span",null,"密度",-1),Fe={class:"s-table"};K();const Ue=we(((e,t,a,n,o,l)=>{const i=O("QuestionCircleOutlined"),s=O("n-icon"),c=O("n-tooltip"),r=O("n-space"),u=O("ReloadOutlined"),d=O("ColumnHeightOutlined"),g=O("n-dropdown"),p=O("ColumnSetting"),f=O("n-data-table");return w(),_(H,null,[T("div",_e,[T(r,{align:"center",class:"table-toolbar-left"},{default:we((()=>[e.title?(w(),_("div",xe,[D(q(e.title)+" ",1),e.titleTooltip?(w(),_(c,{key:0,trigger:"hover"},{trigger:we((()=>[T(s,{size:"18",class:"ml-1 cursor-pointer text-gray-400"},{default:we((()=>[T(i)])),_:1})])),default:we((()=>[D(" "+q(e.titleTooltip),1)])),_:1})):E("",!0)])):E("",!0),I(e.$slots,"tableTitle",{},void 0,!0)])),_:3}),T("div",Te,[I(e.$slots,"toolbar",{},void 0,!0),T(c,{trigger:"hover"},{trigger:we((()=>[T("div",{class:"table-toolbar-right-icon",onClick:t[1]||(t[1]=(...t)=>e.reload&&e.reload(...t))},[T(s,{size:"18"},{default:we((()=>[T(u)])),_:1})])])),default:we((()=>[De])),_:1}),T(c,{trigger:"hover"},{trigger:we((()=>[T("div",Le,[T(g,{onSelect:e.densitySelect,trigger:"click",options:e.densityOptions,value:e.tableSize,"onUpdate:value":t[2]||(t[2]=t=>e.tableSize=t)},{default:we((()=>[T(s,{size:"18"},{default:we((()=>[T(d)])),_:1})])),_:1},8,["onSelect","options","value"])])])),default:we((()=>[Re])),_:1}),T(p)])]),T("div",Fe,[T(f,B(e.getBindValues,{pagination:e.pagination,"onUpdate:page":e.updatePage,"onUpdate:pageSize":e.updatePageSize}),$({_:2},[Q(Object.keys(e.$slots),(t=>({name:t,fn:we((a=>[I(e.$slots,t,a,void 0,!0)]))})))]),1040,["pagination","onUpdate:page","onUpdate:pageSize"])])],64)}));Oe.render=Ue,Oe.__scopeId="data-v-5952b99a";const je=[{title:"id",key:"id"},{title:"名称",key:"name"},{title:"头像",key:"avatar",render:e=>X(J,{size:48,src:e.avatar})},{title:"地址",key:"address"},{title:"开始日期",key:"beginTime"},{title:"结束日期",key:"endTime"},{title:"创建时间",key:"date"},{title:"操作",key:"actions",render:e=>X(W,{size:"small",onClick:()=>{}},{default:()=>"编辑"})}];var Ae=g({components:{ProTable:Oe},setup(){Y();const e=k(),t=y({params:{pageSize:5,name:"xiaoMa"}});return c(s({},S(t)),{columns:je,actionRef:e,loadDataTable:e=>r(this,null,(function*(){return yield function(e){return ae.request({url:"/table/list",method:"get",params:e})}(e)})),onCheckedRow:function(e){},reloadTable:function(){e.value.reload()}})}});const Ve=M();V("data-v-09cb895d");const Ke=D("刷新数据");K();const qe=Ve(((e,t,a,n,o,l)=>{const i=O("n-button"),s=O("ProTable"),c=O("n-card");return w(),_(c,{bordered:!1,class:"proCard"},{default:Ve((()=>[T(s,{title:"表格列表",titleTooltip:"这是一个提示",columns:e.columns,request:e.loadDataTable,"row-key":e=>e.id,ref:"actionRef","onUpdate:checkedRowKeys":e.onCheckedRow},{toolbar:Ve((()=>[T(i,{type:"primary",onClick:e.reloadTable},{default:Ve((()=>[Ke])),_:1},8,["onClick"])])),_:1},8,["columns","request","row-key","onUpdate:checkedRowKeys"])])),_:1})}));Ae.render=qe,Ae.__scopeId="data-v-09cb895d";export default Ae;
