import{B as G}from"./Table-hOMJHovZ.js";import{T as w}from"./TableAction-h2fMWYZW.js";import{A as I,g as z,d as J}from"./index--2wEcaVU.js";import{m as T,k as Q,r as o,e as x,o as W,N as X,O as Y,P as C,a2 as t,a3 as a,j as u,K as c,_ as M}from"./vue-C3qUmXuJ.js";import{H as Z,ah as ee,w as te,a5 as ae,B as ne,h as oe,a7 as le,r as se}from"./naive-ui-zccZ3jep.js";import{_ as ie}from"./CreateModal.vue_vue_type_script_setup_true_lang-BJi171k6.js";import{_ as ue}from"./EditModal.vue_vue_type_script_setup_true_lang-HWIcmSC9.js";import{q as ce}from"./vicons-antd-g9a0d-xa.js";import"./vuedraggable-tl9zbDm_.js";import"./vue-quill-DMQesYph.js";import"./useDesignSetting-BQE1soGM.js";import"./lodash-es-Wid6WkHk.js";import"./propTypes-BvihHqXo.js";import"./componentSetting-DYSsJNsh.js";import"./vueuse-CJoAbtOQ.js";import"./pinia-DjitYwKU.js";import"./vue-router-DVIe63a7.js";import"./vicons-ionicons5-Ctkv33lH.js";import"./BasicForm-BcMXd9Ty.js";import"./useForm-DuIJ5O__.js";import"./useModal-mVBTfGuI.js";function re(i){return I.Get("/role/list",{params:i})}const de=[{title:"id",key:"id"},{title:"角色名称",key:"name"},{title:"说明",key:"explain"},{title:"是否默认角色",key:"isDefault",render(i){return T(Z,{type:i.isDefault?"success":"error"},{default:()=>i.isDefault?"是":"否"})}},{title:"创建时间",key:"create_date"}],fe={class:"n-layout-page-header"},pe={class:"py-3 menu-list"},Ue=Q({__name:"role",setup(i){const v=ee(),k=o(),y=o(),h=o(),r=o(!1),m=o(!1),d=o(!1),g=o(""),f=o([]),l=o([]),s=o(["console","step-form"]),R=x({name:"NaiveAdmin"}),K=x({width:250,title:"操作",key:"action",fixed:"right",render(e){return T(w,{style:"button",actions:[{label:"菜单权限",onClick:E.bind(null,e),ifShow:()=>!0,auth:["basic_list"]},{label:"编辑",onClick:S.bind(null,e),ifShow:()=>!0,auth:["basic_list"]},{label:"删除",onClick:U.bind(null,e),ifShow:()=>!0,auth:["basic_list"]}]})}}),A=async e=>{let n={...c(R),...e};return await re(n)};function B(){y.value.openModal()}function D(e){console.log(e)}function N(){k.value.reload()}function L(e){e.preventDefault(),m.value=!0,setTimeout(()=>{r.value=!1,v.success("提交成功"),N(),m.value=!1},200)}function S(e){console.log("点击了编辑",e),h.value.showModal(e)}function U(e){console.log("点击了删除",e),v.info("点击了删除")}function E(e){g.value=`分配 ${e.name} 的菜单权限`,s.value=e.menu_keys,r.value=!0}function H(e){s.value=[s.value,...e]}function V(e){l.value=e}function $(){l.value.length?l.value=[]:l.value=f.value.map(e=>e.key)}function q(){d.value?(s.value=[],d.value=!1):(s.value=J(f.value),d.value=!0)}return W(async()=>{const e=await z();l.value=e?.list.map(n=>n.key),f.value=e?.list}),(e,n)=>{const b=te,O=oe,p=ne,P=le,j=se,F=ae;return Y(),X("div",null,[C("div",fe,[t(b,{bordered:!1,title:"角色权限管理"},{default:a(()=>n[1]||(n[1]=[u(" 页面数据为 Mock 示例数据，非真实数据。 ",-1)])),_:1,__:[1]})]),t(b,{bordered:!1,class:"mt-4 proCard"},{default:a(()=>[t(c(G),{columns:c(de),request:A,"row-key":_=>_.id,ref_key:"actionRef",ref:k,actionColumn:K,"onUpdate:checkedRowKeys":D},{tableTitle:a(()=>[t(p,{type:"primary",onClick:B},{icon:a(()=>[t(O,null,{default:a(()=>[t(c(ce))]),_:1})]),default:a(()=>[n[2]||(n[2]=u(" 新增角色 ",-1))]),_:1,__:[2]})]),action:a(()=>[t(c(w))]),_:1},8,["columns","row-key","actionColumn"])]),_:1}),t(F,{show:r.value,"onUpdate:show":n[0]||(n[0]=_=>r.value=_),"show-icon":!1,preset:"dialog",title:g.value},{action:a(()=>[t(j,null,{default:a(()=>[t(p,{type:"info",ghost:"","icon-placement":"left",onClick:$},{default:a(()=>[u(" 全部"+M(l.value.length?"收起":"展开"),1)]),_:1}),t(p,{type:"info",ghost:"","icon-placement":"left",onClick:q},{default:a(()=>[u(" 全部"+M(d.value?"取消":"选择"),1)]),_:1}),t(p,{type:"primary",loading:m.value,onClick:L},{default:a(()=>n[3]||(n[3]=[u("提交",-1)])),_:1,__:[3]},8,["loading"])]),_:1})]),default:a(()=>[C("div",pe,[t(P,{"block-line":"",cascade:"",checkable:"","virtual-scroll":!0,data:f.value,expandedKeys:l.value,"checked-keys":s.value,style:{"max-height":"950px",overflow:"hidden"},"onUpdate:checkedKeys":H,"onUpdate:expandedKeys":V},null,8,["data","expandedKeys","checked-keys"])])]),_:1},8,["show","title"]),t(ie,{ref_key:"createModalRef",ref:y},null,512),t(ue,{ref_key:"editModalRef",ref:h},null,512)])}}});export{Ue as default};
