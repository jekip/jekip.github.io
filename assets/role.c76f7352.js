var e=Object.defineProperty,t=Object.defineProperties,a=Object.getOwnPropertyDescriptors,n=Object.getOwnPropertySymbols,l=Object.prototype.hasOwnProperty,o=Object.prototype.propertyIsEnumerable,i=(t,a,n)=>a in t?e(t,a,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[a]=n,d=(e,t,a)=>new Promise(((n,l)=>{var o=e=>{try{d(a.next(e))}catch(t){l(t)}},i=e=>{try{d(a.throw(e))}catch(t){l(t)}},d=e=>e.done?n(e.value):Promise.resolve(e.value).then(o,i);d((a=a.apply(e,t)).next())}));import{_ as c,a as s}from"./TableAction.ad0e414e.js";import{A as r,h as u,k as f}from"./index.e1fec0d3.js";import{s as p,aG as h,d as m,by as y,bV as k,f as b,Z as g,j as w,g as v,i as K,p as x,a as _,V as C,o as T,c as D,b as A,bf as O,t as j,e as P}from"./vendor.af0afcfa.js";import"./useDesignSetting.db6666bf.js";import"./componentSetting.df76d574.js";const R=[{title:"id",key:"id"},{title:"角色名称",key:"name"},{title:"说明",key:"explain"},{title:"是否默认角色",key:"isDefault",render:e=>p(h,{type:e.isDefault?"success":"error"},{default:()=>e.isDefault?"是":"否"})},{title:"创建时间",key:"create_date"}],M={name:{required:!0,trigger:["blur","input"],message:"请输入名称"},address:{required:!0,trigger:["blur","input"],message:"请输入地址"},date:{type:"number",required:!0,trigger:["blur","change"],message:"请选择日期"}};var S=m({components:{BasicTable:c,TableAction:s,PlusOutlined:y,AlignLeftOutlined:k},setup(){const e=b(null),c=g(),h=b(),m=w({showModal:!1,formBtnLoading:!1,checkedAll:!1,editRoleTitle:"",treeData:[],expandedKeys:[],checkedKeys:["console","step-form"],formParams:{name:"",address:"",date:[]},params:{pageSize:5,name:"xiaoMa"},actionColumn:{width:250,title:"操作",dataIndex:"action",fixed:"right",render:e=>p(s,{style:"button",actions:[{label:"菜单权限",onClick:_.bind(null,e),ifShow:()=>!0,auth:["basic_list"]},{label:"编辑",onClick:k.bind(null,e),ifShow:()=>!0,auth:["basic_list"]},{label:"删除",icon:"ic:outline-delete-outline",onClick:x.bind(null,e),ifShow:()=>!0,auth:["basic_list"]}]})}});function y(){h.value.reload()}function k(e){router.push({name:"basic-info",params:{id:e.id}})}function x(e){c.info("点击了删除")}function _(e){m.editRoleTitle=`分配 ${e.name} 的菜单权限`,m.checkedKeys=e.menu_keys,m.showModal=!0}return v((()=>d(this,null,(function*(){const e=yield u();m.expandedKeys=e.list.map((e=>e.key)),m.treeData=e.list})))),C=((e,t)=>{for(var a in t||(t={}))l.call(t,a)&&i(e,a,t[a]);if(n)for(var a of n(t))o.call(t,a)&&i(e,a,t[a]);return e})({},K(m)),t(C,a({formRef:e,columns:R,rules:M,actionRef:h,confirmForm:function(t){t.preventDefault(),m.formBtnLoading=!0,e.value.validate((e=>{e?c.error("请填写完整信息"):(c.success("新建成功"),setTimeout((()=>{m.showModal=!1,y()}))),m.formBtnLoading=!1}))},loadDataTable:e=>d(this,null,(function*(){return yield r.request({url:"/role/list",method:"GET"})})),onCheckedRow:function(e){},reloadTable:y,handleEdit:k,handleDelete:x,handleOpen:function(e){c.info("点击了删除")},handleMenuAuth:_,checkedTree:function(e){m.checkedKeys=[m.checkedKeys,...e]},packHandle:function(){m.expandedKeys.length?m.expandedKeys=[]:m.expandedKeys=m.treeData.map((e=>e.key))},checkedAllHandle:function(){m.checkedAll?(m.checkedKeys=[],m.checkedAll=!1):(m.checkedKeys=f(m.treeData),m.checkedAll=!0)}}));var C}});const q=P();x("data-v-eda5edbe");const B={class:"n-layout-page-header"},L=O(" 页面数据为 Mock 示例数据，非真实数据。 "),U=O(" 添加角色 "),H={class:"py-3 menu-list"},E=O("提交");_();const I=q(((e,t,a,n,l,o)=>{const i=C("n-card"),d=C("PlusOutlined"),c=C("n-icon"),s=C("n-button"),r=C("TableAction"),u=C("BasicTable"),f=C("n-tree"),p=C("n-space"),h=C("n-modal");return T(),D("div",null,[A("div",B,[A(i,{bordered:!1,title:"角色权限管理"},{default:q((()=>[L])),_:1})]),A(i,{bordered:!1,class:"mt-4 proCard"},{default:q((()=>[A(u,{columns:e.columns,request:e.loadDataTable,"row-key":e=>e.id,ref:"actionRef",actionColumn:e.actionColumn,"onUpdate:checkedRowKeys":e.onCheckedRow},{tableTitle:q((()=>[A(s,{type:"primary"},{icon:q((()=>[A(c,null,{default:q((()=>[A(d)])),_:1})])),default:q((()=>[U])),_:1})])),action:q((({record:e})=>[A(r)])),_:1},8,["columns","request","row-key","actionColumn","onUpdate:checkedRowKeys"])])),_:1}),A(h,{show:e.showModal,"onUpdate:show":t[1]||(t[1]=t=>e.showModal=t),"show-icon":!1,preset:"dialog",title:e.editRoleTitle},{action:q((()=>[A(p,null,{default:q((()=>[A(s,{type:"info",ghost:"","icon-placement":"left",onClick:e.packHandle},{default:q((()=>[O(" 全部"+j(e.expandedKeys.length?"收起":"展开"),1)])),_:1},8,["onClick"]),A(s,{type:"info",ghost:"","icon-placement":"left",onClick:e.checkedAllHandle},{default:q((()=>[O(" 全部"+j(e.checkedAll?"取消":"选择"),1)])),_:1},8,["onClick"]),A(s,{type:"primary",loading:e.formBtnLoading,onClick:e.confirmForm},{default:q((()=>[E])),_:1},8,["loading","onClick"])])),_:1})])),default:q((()=>[A("div",H,[A(f,{"block-line":"",cascade:"",checkable:"","virtual-scroll":!0,data:e.treeData,expandedKeys:e.expandedKeys,"checked-keys":e.checkedKeys,style:{"max-height":"950px",overflow:"hidden"},"onUpdate:checkedKeys":e.checkedTree},null,8,["data","expandedKeys","checked-keys","onUpdate:checkedKeys"])])])),_:1},8,["show","title"])])}));S.render=I,S.__scopeId="data-v-eda5edbe";export default S;
