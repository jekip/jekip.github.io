import{a5 as X,B as N,r as W}from"./naive-ui-zccZ3jep.js";import{o as E,q as $}from"./index--2wEcaVU.js";import{k as q,ae as O,r as h,c as S,K as b,a4 as R,O as U,s as j,ab as A,a3 as m,n as K,a2 as k,j as T,_ as P,q as L,P as z,g as Y,w as F}from"./vue-C3qUmXuJ.js";import{a as G}from"./vueuse-CJoAbtOQ.js";const J={...X.props,subBtuText:{type:String,default:"确认"},showIcon:{type:Boolean,default:!1},width:{type:Number,default:446},title:{type:String,default:""},maskClosable:{type:Boolean,default:!1},preset:{type:String,default:"dialog"}},f=function(n,e){return n.currentStyle?n.currentStyle[e]:document.defaultView?.getComputedStyle(n,null)[e]},o={left:0,top:0,currentX:0,currentY:0,flag:!1},Q=function(n,e,y){const u=document.body.clientWidth,_=document.documentElement.clientHeight,d=e.offsetWidth,t=e.offsetHeight,l=e.offsetLeft,c=e.offsetTop,v=u-l-d,w=_-c-t;f(e,"left")!=="auto"&&(o.left=f(e,"left")),f(e,"top")!=="auto"&&(o.top=f(e,"top")),n.onmousedown=function(a){o.flag=!0,a||(a=window.event,n.onselectstart=function(){return!1});const i=a;o.currentX=i.clientX,o.currentY=i.clientY},document.onmouseup=function(){o.flag=!1,f(e,"left")!=="auto"&&(o.left=f(e,"left")),f(e,"top")!=="auto"&&(o.top=f(e,"top"))},document.onmousemove=function(a){const i=a||window.event;if(o.flag){const x=i.clientX,D=i.clientY,B=x-o.currentX,M=D-o.currentY;let p=parseInt(o.left)+B,r=parseInt(o.top)+M;return-p>l?p=-l:p>v&&(p=v),-r>c?r=-c:r>w&&(r=w),e.style.left=p+"px",e.style.top=r+"px",a.preventDefault&&a.preventDefault(),!1}}},Z={class:"w-full cursor-move",id:"basic-modal-bar"},ae=q({__name:"basicModal",props:{...J},emits:["on-close","on-ok","register"],setup(n,{expose:e,emit:y}){const u=O(),_=n,d=y,t=h(null),l=h(!1),c=h(!1),v=S(()=>({..._,...b(t)})),w=S(()=>{const{subBtuText:s}=t.value;return s||_.subBtuText});async function a(s){t.value=E(b(t)||{},s)}const i=S(()=>({...u,...b(v),...b(t)}));function x(s){c.value=s}function D(){l.value=!0,K(()=>{const s=document.getElementById("basic-modal"),g=document.getElementById("basic-modal-bar");Q(g,s)})}function B(){l.value=!1,c.value=!1,d("on-close")}function M(){l.value=!1,d("on-close")}function p(){c.value=!0,d("on-ok")}const r={setProps:a,openModal:D,closeModal:B,setSubLoading:x};return Y()&&d("register",r),e(r),(s,g)=>{const C=N,I=W,V=X;return U(),R(V,j({id:"basic-modal"},i.value,{show:l.value,"onUpdate:show":g[0]||(g[0]=H=>l.value=H),onClose:M}),A({header:m(()=>[z("div",Z,P(i.value.title),1)]),default:m(()=>[L(s.$slots,"default")]),_:2},[s.$slots.action?{name:"action",fn:m(()=>[L(s.$slots,"action")]),key:"1"}:{name:"action",fn:m(()=>[k(I,null,{default:m(()=>[k(C,{onClick:B},{default:m(()=>g[1]||(g[1]=[T("取消",-1)])),_:1,__:[1]}),k(C,{type:"primary",loading:c.value,onClick:p},{default:m(()=>[T(P(w.value),1)]),_:1},8,["loading"])]),_:1})]),key:"0"}]),1040,["show"])}}});function le(n){const e=h(null),y=Y(),u=()=>{const t=b(e.value);return t||console.error("useModal instance is undefined!"),t};return[t=>{G(()=>{e.value=null}),e.value=t,y?.emit("register",t),F(()=>n,()=>{n&&t.setProps($(n))},{immediate:!0,deep:!0})},{setProps:t=>{u()?.setProps(t)},openModal:()=>{u()?.openModal()},closeModal:()=>{u()?.closeModal()},setSubLoading:t=>{u()?.setSubLoading(t)}}]}export{ae as _,le as u};
